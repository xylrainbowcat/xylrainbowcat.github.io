<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="レインボーハウス" href="https://xylrainbowcat.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="レインボーハウス" href="https://xylrainbowcat.github.io/atom.xml"><link rel="alternate" type="application/json" title="レインボーハウス" href="https://xylrainbowcat.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="计软实习项目"><link rel="canonical" href="https://xylrainbowcat.github.io/Project/Student-Information-Management-System/Student-Information-Management-System2/"><title>学生信息管理系统代码实现 - 学生信息管理系统 - 计软实习项目 | RainbowHouse = レインボーハウス = RainbowCat 的技术博客</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">学生信息管理系统代码实现</h1><div class="meta"><span class="item" title="创建时间：2023-01-10 12:44:16"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2023-01-10T12:44:16+08:00">2023-01-10</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>50k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>46 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">RainbowHouse</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://cache.4ce.cn/star3/origin/b8f3a8ec4e21b40d18536f051cbd42f6.jpg"></li><li class="item" data-background-image="https://cache.4ce.cn/star3/origin/1364036884da267252ef80fc4a806fa6.jpg"></li><li class="item" data-background-image="https://i.loli.net/2020/10/30/rjdhcSgEN8COBPA.jpg"></li><li class="item" data-background-image="https://i.loli.net/2020/10/30/Y1CBXqgeokEs457.jpg"></li><li class="item" data-background-image="https://i.loli.net/2020/10/30/HKyzSd7NI3mlBpt.jpg"></li><li class="item" data-background-image="https://cache.4ce.cn/star3/origin/88fbff319cbc51158015f7e68d8e772e.jpg"></li></ul></div><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div></header><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Project/" itemprop="item" rel="index" title="分类于 计软实习项目"><span itemprop="name">计软实习项目</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Project/Student-Information-Management-System/" itemprop="item" rel="index" title="分类于 学生信息管理系统"><span itemprop="name">学生信息管理系统</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://xylrainbowcat.github.io/Project/Student-Information-Management-System/Student-Information-Management-System2/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.png"><meta itemprop="name" content="RainbowCat"><meta itemprop="description" content="RainbowCat 的技术博客, 项目 & 编程笔记"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="レインボーハウス"></span><div class="body md" itemprop="articleBody"><h1 id="头文件"><a class="anchor" href="#头文件">#</a> 头文件</h1><h2 id="globelh"><a class="anchor" href="#globelh">#</a> globel.h</h2><figure class="highlight cpp"><figcaption data-lang="C++"><span>globel.h</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">GLOBEL_H</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">GLOBEL_H</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QGraphicsDropShadowEffect></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QDebug></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QSqlDatabase></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QSqlQuery></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QVariantList></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QMessageBox></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QSqlError></span></span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">const</span> QString USERNAME <span class="token operator">=</span> <span class="token string">"root"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">const</span> QString PASSWORD <span class="token operator">=</span> <span class="token string">"password"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">const</span> QString PASSWORD_WWY <span class="token operator">=</span> <span class="token string">"password"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// GLOBEL_H</span></span></pre></td></tr></table></figure><h2 id="loginwindowh"><a class="anchor" href="#loginwindowh">#</a> loginwindow.h</h2><figure class="highlight cpp"><figcaption data-lang="C++"><span>loginwindow.h</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">LOGINWINDOW_H</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">LOGINWINDOW_H</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"teacherwindow.h"</span></span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"studentwindow.h"</span></span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"reset.h"</span></span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>QT_BEGIN_NAMESPACE</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">namespace</span> Ui <span class="token punctuation">&#123;</span> <span class="token keyword">class</span> <span class="token class-name">LoginWindow</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>QT_END_NAMESPACE</pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">LoginWindow</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">QMainWindow</span></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    Q_OBJECT</pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token function">LoginWindow</span><span class="token punctuation">(</span>QWidget <span class="token operator">*</span>parent <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token operator">~</span><span class="token function">LoginWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">private</span> slots<span class="token operator">:</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_Login_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_Reset_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_Exit_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_Pass_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    Ui<span class="token double-colon punctuation">::</span>LoginWindow <span class="token operator">*</span>ui<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre></pre></td></tr><tr><td data-num="33"></td><td><pre>    QSqlDatabase db<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// LOGINWINDOW_H</span></span></pre></td></tr></table></figure><h2 id="studentwindowh"><a class="anchor" href="#studentwindowh">#</a> studentwindow.h</h2><figure class="highlight cpp"><figcaption data-lang="C++"><span>studentwindow.h</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">STUDENTWINDOW_H</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STUDENTWINDOW_H</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QMainWindow></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"globel.h"</span></span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"changepassword.h"</span></span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">namespace</span> Ui <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">StudentWindow</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">StudentWindow</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">QMainWindow</span></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    Q_OBJECT</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">explicit</span> <span class="token function">StudentWindow</span><span class="token punctuation">(</span>QSqlDatabase db<span class="token punctuation">,</span> QString username<span class="token punctuation">,</span> QWidget <span class="token operator">*</span>parent <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token operator">~</span><span class="token function">StudentWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">init_My</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">init_Course</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">init_Score</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">init_SelectCourse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">SelectCourseRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">SelectedCourseRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre></pre></td></tr><tr><td data-num="30"></td><td><pre>signals<span class="token operator">:</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token keyword">private</span> slots<span class="token operator">:</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_My_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_Course_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre></pre></td></tr><tr><td data-num="38"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_Score_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre></pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_Fee_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre></pre></td></tr><tr><td data-num="42"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_Search_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre></pre></td></tr><tr><td data-num="44"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_comboBox_currentTextChanged</span><span class="token punctuation">(</span><span class="token keyword">const</span> QString <span class="token operator">&amp;</span>arg1<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre></pre></td></tr><tr><td data-num="46"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Compulsory_stateChanged</span><span class="token punctuation">(</span><span class="token keyword">int</span> arg1<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre></pre></td></tr><tr><td data-num="48"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_Exit_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre></pre></td></tr><tr><td data-num="50"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_SearchCourse_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="51"></td><td><pre></pre></td></tr><tr><td data-num="52"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_SelectCourse_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre></pre></td></tr><tr><td data-num="54"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_deleteCourse_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre></pre></td></tr><tr><td data-num="56"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_ScoreTable_3_cellClicked</span><span class="token punctuation">(</span><span class="token keyword">int</span> row<span class="token punctuation">,</span> <span class="token keyword">int</span> column<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="57"></td><td><pre></pre></td></tr><tr><td data-num="58"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_Search_7_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="59"></td><td><pre></pre></td></tr><tr><td data-num="60"></td><td><pre></pre></td></tr><tr><td data-num="61"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="62"></td><td><pre>    Ui<span class="token double-colon punctuation">::</span>StudentWindow <span class="token operator">*</span>ui<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="63"></td><td><pre></pre></td></tr><tr><td data-num="64"></td><td><pre>    QSqlDatabase db<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="65"></td><td><pre></pre></td></tr><tr><td data-num="66"></td><td><pre>    QString username<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="67"></td><td><pre></pre></td></tr><tr><td data-num="68"></td><td><pre>    QString Time <span class="token operator">=</span> <span class="token string">"大三下"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="69"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="70"></td><td><pre></pre></td></tr><tr><td data-num="71"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// STUDENTWINDOW_H</span></span></pre></td></tr></table></figure><h2 id="teacherwindowh"><a class="anchor" href="#teacherwindowh">#</a> teacherwindow.h</h2><figure class="highlight cpp"><figcaption data-lang="C++"><span>teacherwindow.h</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">TEACHERWINDOW_H</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">TEACHERWINDOW_H</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QMainWindow></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"globel.h"</span></span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"modifystudent.h"</span></span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"statics.h"</span></span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"changepassword.h"</span></span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">namespace</span> Ui <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">TeacherWindow</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">TeacherWindow</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">QMainWindow</span></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    Q_OBJECT</pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">explicit</span> <span class="token function">TeacherWindow</span><span class="token punctuation">(</span>QSqlDatabase db<span class="token punctuation">,</span> QString username<span class="token punctuation">,</span> QWidget <span class="token operator">*</span>parent <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token operator">~</span><span class="token function">TeacherWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">init_My</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">init_Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">init_Score</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">init_Dorm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre></pre></td></tr><tr><td data-num="30"></td><td><pre>    QString <span class="token function">calculate_GPA</span><span class="token punctuation">(</span>QString Sno<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre></pre></td></tr><tr><td data-num="32"></td><td><pre>signals<span class="token operator">:</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token keyword">private</span> slots<span class="token operator">:</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_Exit_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre></pre></td></tr><tr><td data-num="38"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_Modify_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre></pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_My_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre></pre></td></tr><tr><td data-num="42"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_Student_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre></pre></td></tr><tr><td data-num="44"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_Score_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre></pre></td></tr><tr><td data-num="46"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_Dorm_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre></pre></td></tr><tr><td data-num="48"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Classno_currentTextChanged</span><span class="token punctuation">(</span><span class="token keyword">const</span> QString <span class="token operator">&amp;</span>arg1<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre></pre></td></tr><tr><td data-num="50"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_Search_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="51"></td><td><pre></pre></td></tr><tr><td data-num="52"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_Save_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre></pre></td></tr><tr><td data-num="54"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_Exchange_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre></pre></td></tr><tr><td data-num="56"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Boy_stateChanged</span><span class="token punctuation">(</span><span class="token keyword">int</span> arg1<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="57"></td><td><pre></pre></td></tr><tr><td data-num="58"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Gril_stateChanged</span><span class="token punctuation">(</span><span class="token keyword">int</span> arg1<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="59"></td><td><pre></pre></td></tr><tr><td data-num="60"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_Add_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="61"></td><td><pre></pre></td></tr><tr><td data-num="62"></td><td><pre></pre></td></tr><tr><td data-num="63"></td><td><pre></pre></td></tr><tr><td data-num="64"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_stat_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="65"></td><td><pre></pre></td></tr><tr><td data-num="66"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_Delete_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="67"></td><td><pre></pre></td></tr><tr><td data-num="68"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_StudentTable_cellClicked</span><span class="token punctuation">(</span><span class="token keyword">int</span> row<span class="token punctuation">,</span> <span class="token keyword">int</span> column<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="69"></td><td><pre></pre></td></tr><tr><td data-num="70"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_Search_7_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="71"></td><td><pre></pre></td></tr><tr><td data-num="72"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="73"></td><td><pre>    Ui<span class="token double-colon punctuation">::</span>TeacherWindow <span class="token operator">*</span>ui<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="74"></td><td><pre></pre></td></tr><tr><td data-num="75"></td><td><pre>    QSqlDatabase db<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="76"></td><td><pre></pre></td></tr><tr><td data-num="77"></td><td><pre>    QString username<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="78"></td><td><pre></pre></td></tr><tr><td data-num="79"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="80"></td><td><pre></pre></td></tr><tr><td data-num="81"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// TEACHERWINDOW_H</span></span></pre></td></tr></table></figure><h2 id="modifystudenth"><a class="anchor" href="#modifystudenth">#</a> modifystudent.h</h2><figure class="highlight cpp"><figcaption data-lang="C++"><span>modifystudent.h</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">MODIFYSTUDENT_H</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MODIFYSTUDENT_H</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QMainWindow></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"globel.h"</span></span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">enum</span> <span class="token class-name">MODIFY_ADD</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    MODIFY<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    ADD</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">namespace</span> Ui <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">ModifyStudent</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">ModifyStudent</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">QMainWindow</span></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    Q_OBJECT</pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">explicit</span> <span class="token function">ModifyStudent</span><span class="token punctuation">(</span>QSqlDatabase db<span class="token punctuation">,</span> QString username<span class="token punctuation">,</span> <span class="token keyword">int</span> model<span class="token punctuation">,</span> QWidget <span class="token operator">*</span>parent <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token operator">~</span><span class="token function">ModifyStudent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre>signals<span class="token operator">:</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token keyword">private</span> slots<span class="token operator">:</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_Cancel_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_Save_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    Ui<span class="token double-colon punctuation">::</span>ModifyStudent <span class="token operator">*</span>ui<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre>    QSqlDatabase db<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre></pre></td></tr><tr><td data-num="38"></td><td><pre>    QString username<span class="token punctuation">;</span> <span class="token comment">// 要修改的学号</span></pre></td></tr><tr><td data-num="39"></td><td><pre></pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token keyword">int</span> Model<span class="token punctuation">;</span> <span class="token comment">//0 修改；1 新增</span></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre></pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// MODIFYSTUDENT_H</span></span></pre></td></tr></table></figure><h2 id="changepasswordh"><a class="anchor" href="#changepasswordh">#</a> changepassword.h</h2><figure class="highlight cpp"><figcaption data-lang="C++"><span>changepassword.h</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">CHANGEPASSWORD_H</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">CHANGEPASSWORD_H</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QWidget></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"globel.h"</span></span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">enum</span> <span class="token class-name">USER_TYPE</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    TEACHER<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    STUDENT</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">namespace</span> Ui <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">changePassword</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">changePassword</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">QWidget</span></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    Q_OBJECT</pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">explicit</span> <span class="token function">changePassword</span><span class="token punctuation">(</span>QSqlDatabase db<span class="token punctuation">,</span> QString username<span class="token punctuation">,</span> <span class="token keyword">int</span> UserType<span class="token punctuation">,</span>  QWidget <span class="token operator">*</span>parent <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token operator">~</span><span class="token function">changePassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">private</span> slots<span class="token operator">:</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_Confirm_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_Cancel_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    Ui<span class="token double-colon punctuation">::</span>changePassword <span class="token operator">*</span>ui<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre></pre></td></tr><tr><td data-num="32"></td><td><pre>    QSqlDatabase data<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre></pre></td></tr><tr><td data-num="34"></td><td><pre>    QString username<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token keyword">int</span> userType<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre></pre></td></tr><tr><td data-num="38"></td><td><pre>    <span class="token keyword">int</span> interfaceType<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// CHANGEPASSWORD_H</span></span></pre></td></tr></table></figure><h2 id="reseth"><a class="anchor" href="#reseth">#</a> reset.h</h2><figure class="highlight cpp"><figcaption data-lang="C++"><span>reset.h</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">RESET_H</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">RESET_H</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QWidget></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"globel.h"</span></span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">namespace</span> Ui <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Reset</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Reset</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">QWidget</span></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    Q_OBJECT</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">explicit</span> <span class="token function">Reset</span><span class="token punctuation">(</span>QString name<span class="token punctuation">,</span> QWidget <span class="token operator">*</span>parent <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token operator">~</span><span class="token function">Reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre>signals<span class="token operator">:</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">private</span> slots<span class="token operator">:</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_No_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_Yes_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    Ui<span class="token double-colon punctuation">::</span>Reset <span class="token operator">*</span>ui<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre>    QString name<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// RESET_H</span></span></pre></td></tr></table></figure><h2 id="staticsh"><a class="anchor" href="#staticsh">#</a> statics.h</h2><figure class="highlight cpp"><figcaption data-lang="C++"><span>statics.h</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">STATICS_H</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">STATICS_H</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;QWidget></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"globel.h"</span></span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">namespace</span> Ui <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Statics</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Statics</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">QWidget</span></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    Q_OBJECT</pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">public</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">explicit</span> <span class="token function">Statics</span><span class="token punctuation">(</span>QSqlDatabase db<span class="token punctuation">,</span> QString course<span class="token punctuation">,</span> QWidget <span class="token operator">*</span>parent <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token operator">~</span><span class="token function">Statics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">avg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">per</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">private</span> slots<span class="token operator">:</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">void</span> <span class="token function">on_Btn_yes_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">private</span><span class="token operator">:</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    Ui<span class="token double-colon punctuation">::</span>Statics <span class="token operator">*</span>ui<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre>    QSqlDatabase database<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre>    QString course<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span> <span class="token comment">// STATICS_H</span></span></pre></td></tr></table></figure><h1 id="源文件"><a class="anchor" href="#源文件">#</a> 源文件</h1><h2 id="loginwindowcpp"><a class="anchor" href="#loginwindowcpp">#</a> loginwindow.cpp</h2><figure class="highlight cpp"><figcaption data-lang="C++"><span>loginwindow.cpp</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"loginwindow.h"</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ui_loginwindow.h"</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token class-name">LoginWindow</span><span class="token double-colon punctuation">::</span><span class="token function">LoginWindow</span><span class="token punctuation">(</span>QWidget <span class="token operator">*</span>parent<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">QMainWindow</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">ui</span><span class="token punctuation">(</span><span class="token keyword">new</span> Ui<span class="token double-colon punctuation">::</span>LoginWindow<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    ui<span class="token operator">-></span><span class="token function">setupUi</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token function">setWindowFlags</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>CustomizeWindowHint<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 隐藏标题栏</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token function">setFixedSize</span><span class="token punctuation">(</span><span class="token number">630</span><span class="token punctuation">,</span> <span class="token number">420</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>    ui<span class="token operator">-></span>Login_Password<span class="token operator">-></span><span class="token function">setEchoMode</span><span class="token punctuation">(</span>QLineEdit<span class="token double-colon punctuation">::</span>Password<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 小黑点代替输入</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    ui<span class="token operator">-></span>Login_Username<span class="token operator">-></span><span class="token function">setPlaceholderText</span><span class="token punctuation">(</span><span class="token string">"请输入用户名"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    ui<span class="token operator">-></span>Login_Password<span class="token operator">-></span><span class="token function">setPlaceholderText</span><span class="token punctuation">(</span><span class="token string">"请输入密码"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    ui<span class="token operator">-></span>Mode_Student<span class="token operator">-></span><span class="token function">setChecked</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 设置默认选项</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token comment">//ui->Login_Username->setText("202241803629");</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token comment">//ui->Login_Password->setText("812814");</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">QSqlDatabase</span><span class="token double-colon punctuation">::</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"qt_sql_default_connection"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                    <span class="token comment">// 连接数据库</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        db <span class="token operator">=</span> <span class="token class-name">QSqlDatabase</span><span class="token double-colon punctuation">::</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token string">"qt_sql_default_connection"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">else</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        db <span class="token operator">=</span> <span class="token class-name">QSqlDatabase</span><span class="token double-colon punctuation">::</span><span class="token function">addDatabase</span><span class="token punctuation">(</span><span class="token string">"QMYSQL"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token comment">//          db = QSqlDatabase::addDatabase("QODBC");</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre>    db<span class="token punctuation">.</span><span class="token function">setHostName</span><span class="token punctuation">(</span><span class="token string">"localhost"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    db<span class="token punctuation">.</span><span class="token function">setDatabaseName</span><span class="token punctuation">(</span><span class="token string">"studentmanager"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    db<span class="token punctuation">.</span><span class="token function">setUserName</span><span class="token punctuation">(</span>USERNAME<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token comment">//    db.setPassword(PASSWORD);</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    db<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span>PASSWORD_WWY<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>db<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"Failed to connect to root mysql admin"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token keyword">else</span> <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"open"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token class-name">LoginWindow</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">LoginWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token keyword">delete</span> ui<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="38"></td><td><pre></pre></td></tr><tr><td data-num="39"></td><td><pre></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token comment">// =============================================================================== 登陆按钮</span></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">LoginWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_Login_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>    QString username <span class="token operator">=</span> ui<span class="token operator">-></span>Login_Username<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>    QString password <span class="token operator">=</span> ui<span class="token operator">-></span>Login_Password<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre></pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"用户名："</span> <span class="token operator">&lt;&lt;</span> username <span class="token operator">&lt;&lt;</span> <span class="token string">"密码:"</span> <span class="token operator">&lt;&lt;</span> password<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="46"></td><td><pre></pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>ui<span class="token operator">-></span>Mode_Teacher<span class="token operator">-></span><span class="token function">isChecked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                                        <span class="token comment">// 登陆教师端</span></pre></td></tr><tr><td data-num="48"></td><td><pre>        QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>        query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select password "</span></pre></td></tr><tr><td data-num="50"></td><td><pre>                   <span class="token string">"from teacher "</span></pre></td></tr><tr><td data-num="51"></td><td><pre>                   <span class="token string">"where tno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="52"></td><td><pre></pre></td></tr><tr><td data-num="53"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> password <span class="token operator">==</span> query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>                <span class="token keyword">this</span><span class="token operator">-></span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>                TeacherWindow <span class="token operator">*</span>teacher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">TeacherWindow</span><span class="token punctuation">(</span>db<span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>                teacher<span class="token operator">-></span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="57"></td><td><pre></pre></td></tr><tr><td data-num="58"></td><td><pre>                <span class="token function">connect</span><span class="token punctuation">(</span>teacher<span class="token punctuation">,</span> <span class="token operator">&amp;</span>TeacherWindow<span class="token double-colon punctuation">::</span>back<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">=</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="59"></td><td><pre>                    <span class="token keyword">this</span><span class="token operator">-></span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="60"></td><td><pre>                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="61"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="62"></td><td><pre>        <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="63"></td><td><pre>            QMessageBox box<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="64"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Critical<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="65"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/res/logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="66"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"警告"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="67"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"用户名或密码错误"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="68"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="69"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="70"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="71"></td><td><pre></pre></td></tr><tr><td data-num="72"></td><td><pre>    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                                                                      <span class="token comment">// 登陆学生端</span></pre></td></tr><tr><td data-num="73"></td><td><pre>        QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="74"></td><td><pre>        query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select password "</span></pre></td></tr><tr><td data-num="75"></td><td><pre>                   <span class="token string">"from student "</span></pre></td></tr><tr><td data-num="76"></td><td><pre>                   <span class="token string">"where sno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="77"></td><td><pre></pre></td></tr><tr><td data-num="78"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> password <span class="token operator">==</span> query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="79"></td><td><pre>                <span class="token keyword">this</span><span class="token operator">-></span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="80"></td><td><pre>                StudentWindow <span class="token operator">*</span>student <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">StudentWindow</span><span class="token punctuation">(</span>db<span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="81"></td><td><pre>                student<span class="token operator">-></span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="82"></td><td><pre></pre></td></tr><tr><td data-num="83"></td><td><pre>                <span class="token function">connect</span><span class="token punctuation">(</span>student<span class="token punctuation">,</span> <span class="token operator">&amp;</span>StudentWindow<span class="token double-colon punctuation">::</span>back<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">=</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="84"></td><td><pre>                    <span class="token keyword">this</span><span class="token operator">-></span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="85"></td><td><pre>                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="86"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="87"></td><td><pre>        <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="88"></td><td><pre>            QMessageBox box<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="89"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Critical<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="90"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/res/logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="91"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"警告"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="92"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"用户名或密码错误"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="93"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="94"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="95"></td><td><pre></pre></td></tr><tr><td data-num="96"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="97"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="98"></td><td><pre></pre></td></tr><tr><td data-num="99"></td><td><pre><span class="token comment">// =============================================================================== 重置按钮</span></pre></td></tr><tr><td data-num="100"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">LoginWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_Reset_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="101"></td><td><pre>    ui<span class="token operator">-></span>Login_Username<span class="token operator">-></span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="102"></td><td><pre>    ui<span class="token operator">-></span>Login_Password<span class="token operator">-></span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="103"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="104"></td><td><pre></pre></td></tr><tr><td data-num="105"></td><td><pre><span class="token comment">// =============================================================================== 退出按钮</span></pre></td></tr><tr><td data-num="106"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">LoginWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_Exit_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="107"></td><td><pre>    <span class="token keyword">this</span><span class="token operator">-></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="108"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="109"></td><td><pre></pre></td></tr><tr><td data-num="110"></td><td><pre><span class="token comment">// =============================================================================== 忘记密码</span></pre></td></tr><tr><td data-num="111"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">LoginWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_Pass_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="112"></td><td><pre>    QString username <span class="token operator">=</span> ui<span class="token operator">-></span>Login_Username<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="113"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>username <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="114"></td><td><pre>        QMessageBox box<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="115"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Warning<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="116"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/res/logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="117"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"警告"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="118"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"请输入用户名"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="119"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="120"></td><td><pre>        <span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="121"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="122"></td><td><pre></pre></td></tr><tr><td data-num="123"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>ui<span class="token operator">-></span>Mode_Teacher<span class="token operator">-></span><span class="token function">isChecked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="124"></td><td><pre>        QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="125"></td><td><pre>        query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select tname from teacher where tno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="126"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="127"></td><td><pre>            Reset <span class="token operator">*</span>reset <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Reset</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="128"></td><td><pre>            reset<span class="token operator">-></span><span class="token function">setWindowModality</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>ApplicationModal<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="129"></td><td><pre>            reset<span class="token operator">-></span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="130"></td><td><pre></pre></td></tr><tr><td data-num="131"></td><td><pre>            <span class="token function">connect</span><span class="token punctuation">(</span>reset<span class="token punctuation">,</span> <span class="token operator">&amp;</span>Reset<span class="token double-colon punctuation">::</span>reset<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">=</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="132"></td><td><pre>                QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="133"></td><td><pre>                query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"update teacher set password = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"' where tno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="134"></td><td><pre>                QMessageBox box<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="135"></td><td><pre>                box<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Information<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="136"></td><td><pre>                box<span class="token punctuation">.</span><span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/res/logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="137"></td><td><pre>                box<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"警告"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="138"></td><td><pre>                box<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"密码已重置为您的职工号"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="139"></td><td><pre>                box<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="140"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="141"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="142"></td><td><pre>        <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="143"></td><td><pre>            QMessageBox box<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="144"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Warning<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="145"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/res/logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="146"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"警告"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="147"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"请输入正确的用户名"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="148"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="149"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="150"></td><td><pre></pre></td></tr><tr><td data-num="151"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="152"></td><td><pre>    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="153"></td><td><pre>        QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="154"></td><td><pre>        query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select sname from student where sno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="155"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="156"></td><td><pre>            Reset <span class="token operator">*</span>reset <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Reset</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="157"></td><td><pre>            reset<span class="token operator">-></span><span class="token function">setWindowModality</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>ApplicationModal<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="158"></td><td><pre>            reset<span class="token operator">-></span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="159"></td><td><pre></pre></td></tr><tr><td data-num="160"></td><td><pre>            <span class="token function">connect</span><span class="token punctuation">(</span>reset<span class="token punctuation">,</span> <span class="token operator">&amp;</span>Reset<span class="token double-colon punctuation">::</span>reset<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">=</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="161"></td><td><pre>                QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="162"></td><td><pre>                query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"update student set password = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"' where sno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="163"></td><td><pre>                QMessageBox box<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="164"></td><td><pre>                box<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Information<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="165"></td><td><pre>                box<span class="token punctuation">.</span><span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/res/logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="166"></td><td><pre>                box<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"警告"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="167"></td><td><pre>                box<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"密码已重置为您的学号"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="168"></td><td><pre>                box<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="169"></td><td><pre>            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="170"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="171"></td><td><pre>        <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="172"></td><td><pre>            QMessageBox box<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="173"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Warning<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="174"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/res/logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="175"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"警告"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="176"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"请输入正确的用户名"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="177"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="178"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="179"></td><td><pre></pre></td></tr><tr><td data-num="180"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="181"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="studentwindowcpp"><a class="anchor" href="#studentwindowcpp">#</a> studentwindow.cpp</h2><figure class="highlight cpp"><figcaption data-lang="C++"><span>studentwindow.cpp</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"studentwindow.h"</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ui_studentwindow.h"</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token class-name">StudentWindow</span><span class="token double-colon punctuation">::</span><span class="token function">StudentWindow</span><span class="token punctuation">(</span>QSqlDatabase db<span class="token punctuation">,</span> QString username<span class="token punctuation">,</span> QWidget <span class="token operator">*</span>parent<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">QMainWindow</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">ui</span><span class="token punctuation">(</span><span class="token keyword">new</span> Ui<span class="token double-colon punctuation">::</span>StudentWindow<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    ui<span class="token operator">-></span><span class="token function">setupUi</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/res/logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                             <span class="token comment">// 设置窗口样式</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"江苏科技大学学生管理系统"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">this</span><span class="token operator">-></span><span class="token function">setStyleSheet</span><span class="token punctuation">(</span><span class="token string">"background-color: rgb(255, 255, 255);"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token function">resize</span><span class="token punctuation">(</span><span class="token number">1170</span><span class="token punctuation">,</span> <span class="token number">672</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>    QGraphicsDropShadowEffect <span class="token operator">*</span>shadow_effect <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QGraphicsDropShadowEffect</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 侧边栏阴影效果</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    shadow_effect<span class="token operator">-></span><span class="token function">setOffset</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    shadow_effect<span class="token operator">-></span><span class="token function">setColor</span><span class="token punctuation">(</span><span class="token function">QColor</span><span class="token punctuation">(</span><span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">78</span><span class="token punctuation">,</span> <span class="token number">119</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    shadow_effect<span class="token operator">-></span><span class="token function">setBlurRadius</span><span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    ui<span class="token operator">-></span>Sidebar<span class="token operator">-></span><span class="token function">setGraphicsEffect</span><span class="token punctuation">(</span>shadow_effect<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre>    ui<span class="token operator">-></span>CourseTable<span class="token operator">-></span><span class="token function">horizontalHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setSectionResizeMode</span><span class="token punctuation">(</span>QHeaderView<span class="token double-colon punctuation">::</span>Stretch<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 表格随窗口调整大小</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">horizontalHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setSectionResizeMode</span><span class="token punctuation">(</span>QHeaderView<span class="token double-colon punctuation">::</span>Stretch<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre>    ui<span class="token operator">-></span>comboBox<span class="token operator">-></span><span class="token function">view</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setWindowFlags</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>Popup<span class="token operator">|</span>Qt<span class="token double-colon punctuation">::</span>FramelessWindowHint<span class="token operator">|</span>Qt<span class="token double-colon punctuation">::</span>NoDropShadowWindowHint<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    ui<span class="token operator">-></span>comboBox<span class="token operator">-></span><span class="token function">view</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setAttribute</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>WA_TranslucentBackground<span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">// 下拉框圆角</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre>    ui<span class="token operator">-></span>Body<span class="token operator">-></span><span class="token function">setCurrentIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                                       <span class="token comment">// 初始化第一个窗口和成员变量</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token keyword">this</span><span class="token operator">-></span>db <span class="token operator">=</span> db<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">this</span><span class="token operator">-></span>username <span class="token operator">=</span> username<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token function">init_My</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                                                          <span class="token comment">// 调用初始化函数</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token function">init_Course</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token function">init_Score</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token function">init_SelectCourse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token class-name">StudentWindow</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">StudentWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token keyword">delete</span> ui<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="38"></td><td><pre></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token comment">// ======================================================================================= 初始化基本信息界面</span></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">StudentWindow</span><span class="token double-colon punctuation">::</span><span class="token function">init_My</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select sno, sname, sex, age, major, classno, status, dormitory, bednum, jiangcheng "</span></pre></td></tr><tr><td data-num="43"></td><td><pre>               <span class="token string">"from student "</span></pre></td></tr><tr><td data-num="44"></td><td><pre>               <span class="token string">"where sno ='"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre></pre></td></tr><tr><td data-num="46"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>    ui<span class="token operator">-></span>Sno<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>    ui<span class="token operator">-></span>Sname<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>    ui<span class="token operator">-></span>Sex<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>    ui<span class="token operator">-></span>Age<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>    ui<span class="token operator">-></span>Major<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>    ui<span class="token operator">-></span>Classno<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>    ui<span class="token operator">-></span>Status<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>    ui<span class="token operator">-></span>Dorm<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"-"</span> <span class="token operator">+</span> query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>    ui<span class="token operator">-></span>Jiangcheng<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="56"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="57"></td><td><pre></pre></td></tr><tr><td data-num="58"></td><td><pre><span class="token comment">// ======================================================================================= 初始化课程查询界面</span></pre></td></tr><tr><td data-num="59"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">StudentWindow</span><span class="token double-colon punctuation">::</span><span class="token function">init_Course</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="60"></td><td><pre>    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="61"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select sc.cno, cname, tname, time, period, credit, assess, property "</span></pre></td></tr><tr><td data-num="62"></td><td><pre>               <span class="token string">"from course, sc, teacher "</span></pre></td></tr><tr><td data-num="63"></td><td><pre>               <span class="token string">"where sc.cno = course.cno and course.tno = teacher.tno and sno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="64"></td><td><pre></pre></td></tr><tr><td data-num="65"></td><td><pre>    QStringList headerlist<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="66"></td><td><pre>    headerlist<span class="token operator">&lt;&lt;</span><span class="token string">"课程号"</span><span class="token operator">&lt;&lt;</span><span class="token string">"课程名"</span><span class="token operator">&lt;&lt;</span><span class="token string">"任课老师"</span><span class="token operator">&lt;&lt;</span><span class="token string">"开课学期"</span><span class="token operator">&lt;&lt;</span><span class="token string">"学时"</span><span class="token operator">&lt;&lt;</span><span class="token string">"学分"</span><span class="token operator">&lt;&lt;</span><span class="token string">"考核方式"</span><span class="token operator">&lt;&lt;</span><span class="token string">"课程属性"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="67"></td><td><pre>    ui<span class="token operator">-></span>CourseTable<span class="token operator">-></span><span class="token function">setColumnCount</span><span class="token punctuation">(</span>headerlist<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="68"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ui<span class="token operator">-></span>CourseTable<span class="token operator">-></span><span class="token function">columnCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="69"></td><td><pre>        ui<span class="token operator">-></span>CourseTable<span class="token operator">-></span><span class="token function">setHorizontalHeaderItem</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>headerlist<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="70"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="71"></td><td><pre>    ui<span class="token operator">-></span>CourseTable<span class="token operator">-></span><span class="token function">horizontalHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setStyleSheet</span><span class="token punctuation">(</span><span class="token string">"QHeaderView::section&#123;font: Bold 13pt '微软雅黑'&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="72"></td><td><pre>    ui<span class="token operator">-></span>CourseTable<span class="token operator">-></span><span class="token function">horizontalHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setVisible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="73"></td><td><pre></pre></td></tr><tr><td data-num="74"></td><td><pre>    <span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="75"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="76"></td><td><pre>        ui<span class="token operator">-></span>CourseTable<span class="token operator">-></span><span class="token function">insertRow</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="77"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ui<span class="token operator">-></span>CourseTable<span class="token operator">-></span><span class="token function">columnCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="78"></td><td><pre>            ui<span class="token operator">-></span>CourseTable<span class="token operator">-></span><span class="token function">setItem</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="79"></td><td><pre>            ui<span class="token operator">-></span>CourseTable<span class="token operator">-></span><span class="token function">item</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setTextAlignment</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>AlignCenter<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="80"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="81"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="82"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="83"></td><td><pre></pre></td></tr><tr><td data-num="84"></td><td><pre><span class="token comment">// ======================================================================================= 初始化成绩查询界面</span></pre></td></tr><tr><td data-num="85"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">StudentWindow</span><span class="token double-colon punctuation">::</span><span class="token function">init_Score</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="86"></td><td><pre>    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="87"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select sc.cno, cname, time, score, period, credit, assess, property "</span></pre></td></tr><tr><td data-num="88"></td><td><pre>               <span class="token string">"from course, sc "</span></pre></td></tr><tr><td data-num="89"></td><td><pre>               <span class="token string">"where sc.cno = course.cno and sno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="90"></td><td><pre></pre></td></tr><tr><td data-num="91"></td><td><pre>    QStringList headerlist<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="92"></td><td><pre>    headerlist<span class="token operator">&lt;&lt;</span><span class="token string">"课程号"</span><span class="token operator">&lt;&lt;</span><span class="token string">"课程名"</span><span class="token operator">&lt;&lt;</span><span class="token string">"开课学期"</span><span class="token operator">&lt;&lt;</span><span class="token string">"成绩"</span><span class="token operator">&lt;&lt;</span><span class="token string">"学时"</span><span class="token operator">&lt;&lt;</span><span class="token string">"学分"</span><span class="token operator">&lt;&lt;</span><span class="token string">"考核方式"</span><span class="token operator">&lt;&lt;</span><span class="token string">"课程属性"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="93"></td><td><pre>    ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">setColumnCount</span><span class="token punctuation">(</span>headerlist<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="94"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">columnCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="95"></td><td><pre>        ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">setHorizontalHeaderItem</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>headerlist<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="96"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="97"></td><td><pre>    ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">horizontalHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setStyleSheet</span><span class="token punctuation">(</span><span class="token string">"QHeaderView::section&#123;font: Bold 13pt '微软雅黑'&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="98"></td><td><pre>    ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">horizontalHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setVisible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="99"></td><td><pre></pre></td></tr><tr><td data-num="100"></td><td><pre>    <span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="101"></td><td><pre>    <span class="token keyword">double</span> GPA <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> credit <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="102"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="103"></td><td><pre>        ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">insertRow</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="104"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">columnCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="105"></td><td><pre>            ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">setItem</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="106"></td><td><pre>            ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">item</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setTextAlignment</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>AlignCenter<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="107"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="108"></td><td><pre></pre></td></tr><tr><td data-num="109"></td><td><pre>        GPA <span class="token operator">+=</span> std<span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">10</span> <span class="token operator">*</span> query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="110"></td><td><pre>        credit <span class="token operator">+=</span> query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="111"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="112"></td><td><pre></pre></td></tr><tr><td data-num="113"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>credit<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="114"></td><td><pre>        ui<span class="token operator">-></span>GPA<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>GPA <span class="token operator">/</span> credit<span class="token punctuation">,</span> <span class="token char">'f'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="115"></td><td><pre>    <span class="token keyword">else</span> ui<span class="token operator">-></span>GPA<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"0.000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="116"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="117"></td><td><pre></pre></td></tr><tr><td data-num="118"></td><td><pre><span class="token comment">// ======================================================================================= 搜索按钮</span></pre></td></tr><tr><td data-num="119"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">StudentWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_Search_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="120"></td><td><pre>    QString time <span class="token operator">=</span> ui<span class="token operator">-></span>Time<span class="token operator">-></span><span class="token function">currentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="121"></td><td><pre>    QString cname <span class="token operator">=</span> ui<span class="token operator">-></span>Cname<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="122"></td><td><pre></pre></td></tr><tr><td data-num="123"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>time <span class="token operator">==</span> <span class="token string">" 全部"</span><span class="token punctuation">)</span> time <span class="token operator">=</span> <span class="token string">"%"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="124"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>cname <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">)</span> cname <span class="token operator">=</span> <span class="token string">"%"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="125"></td><td><pre></pre></td></tr><tr><td data-num="126"></td><td><pre>    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="127"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select sc.cno, cname, tname, time, period, credit, assess, property "</span></pre></td></tr><tr><td data-num="128"></td><td><pre>               <span class="token string">"from course, sc, teacher "</span></pre></td></tr><tr><td data-num="129"></td><td><pre>               <span class="token string">"where sc.cno = course.cno and course.tno = teacher.tno and sno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"' "</span></pre></td></tr><tr><td data-num="130"></td><td><pre>                     <span class="token string">"and time like '%"</span> <span class="token operator">+</span> time <span class="token operator">+</span> <span class="token string">"%' and cname like '%"</span> <span class="token operator">+</span> cname <span class="token operator">+</span> <span class="token string">"%'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="131"></td><td><pre></pre></td></tr><tr><td data-num="132"></td><td><pre>    ui<span class="token operator">-></span>CourseTable<span class="token operator">-></span><span class="token function">clearContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="133"></td><td><pre>    ui<span class="token operator">-></span>CourseTable<span class="token operator">-></span><span class="token function">setRowCount</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="134"></td><td><pre>    <span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="135"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="136"></td><td><pre>        ui<span class="token operator">-></span>CourseTable<span class="token operator">-></span><span class="token function">insertRow</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="137"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ui<span class="token operator">-></span>CourseTable<span class="token operator">-></span><span class="token function">columnCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="138"></td><td><pre>            ui<span class="token operator">-></span>CourseTable<span class="token operator">-></span><span class="token function">setItem</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="139"></td><td><pre>            ui<span class="token operator">-></span>CourseTable<span class="token operator">-></span><span class="token function">item</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setTextAlignment</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>AlignCenter<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="140"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="141"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="142"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="143"></td><td><pre></pre></td></tr><tr><td data-num="144"></td><td><pre><span class="token comment">// ======================================================================================= 选择学期下拉框</span></pre></td></tr><tr><td data-num="145"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">StudentWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_comboBox_currentTextChanged</span><span class="token punctuation">(</span><span class="token keyword">const</span> QString <span class="token operator">&amp;</span>arg1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="146"></td><td><pre>    <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> arg1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="147"></td><td><pre></pre></td></tr><tr><td data-num="148"></td><td><pre>    QString time <span class="token operator">=</span> arg1<span class="token punctuation">,</span> property <span class="token operator">=</span> <span class="token string">"%"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="149"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>time <span class="token operator">==</span> <span class="token string">" 全部"</span><span class="token punctuation">)</span> time <span class="token operator">=</span> <span class="token string">"%"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="150"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>ui<span class="token operator">-></span>Compulsory<span class="token operator">-></span><span class="token function">isChecked</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> property <span class="token operator">=</span> <span class="token string">"必修"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="151"></td><td><pre></pre></td></tr><tr><td data-num="152"></td><td><pre>    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="153"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select sc.cno, cname, time, score, period, credit, assess, property "</span></pre></td></tr><tr><td data-num="154"></td><td><pre>               <span class="token string">"from course, sc "</span></pre></td></tr><tr><td data-num="155"></td><td><pre>               <span class="token string">"where sc.cno = course.cno and sno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"' and time like '"</span> <span class="token operator">+</span> time <span class="token operator">+</span> <span class="token string">"' and property like '"</span> <span class="token operator">+</span> property <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="156"></td><td><pre></pre></td></tr><tr><td data-num="157"></td><td><pre>    ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">clearContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="158"></td><td><pre>    ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">setRowCount</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="159"></td><td><pre>    <span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="160"></td><td><pre>    <span class="token keyword">double</span> GPA <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> credit <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="161"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="162"></td><td><pre>        ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">insertRow</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="163"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">columnCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="164"></td><td><pre>            ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">setItem</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="165"></td><td><pre>            ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">item</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setTextAlignment</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>AlignCenter<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="166"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="167"></td><td><pre></pre></td></tr><tr><td data-num="168"></td><td><pre>        GPA <span class="token operator">+=</span> std<span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">10</span> <span class="token operator">*</span> query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="169"></td><td><pre>        credit <span class="token operator">+=</span> query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="170"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="171"></td><td><pre></pre></td></tr><tr><td data-num="172"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>credit<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="173"></td><td><pre>        ui<span class="token operator">-></span>GPA<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>GPA <span class="token operator">/</span> credit<span class="token punctuation">,</span> <span class="token char">'f'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="174"></td><td><pre>    <span class="token keyword">else</span> ui<span class="token operator">-></span>GPA<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"0.000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="175"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="176"></td><td><pre></pre></td></tr><tr><td data-num="177"></td><td><pre><span class="token comment">// ======================================================================================= 只看必修</span></pre></td></tr><tr><td data-num="178"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">StudentWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Compulsory_stateChanged</span><span class="token punctuation">(</span><span class="token keyword">int</span> arg1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="179"></td><td><pre>    <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> arg1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="180"></td><td><pre></pre></td></tr><tr><td data-num="181"></td><td><pre>    QString time <span class="token operator">=</span> ui<span class="token operator">-></span>comboBox<span class="token operator">-></span><span class="token function">currentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> property <span class="token operator">=</span> arg1 <span class="token operator">?</span> <span class="token string">"必修"</span> <span class="token operator">:</span> <span class="token string">"%"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="182"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>time <span class="token operator">==</span> <span class="token string">" 全部"</span><span class="token punctuation">)</span> time <span class="token operator">=</span> <span class="token string">"%"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="183"></td><td><pre></pre></td></tr><tr><td data-num="184"></td><td><pre>    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="185"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select sc.cno, cname, time, score, period, credit, assess, property "</span></pre></td></tr><tr><td data-num="186"></td><td><pre>               <span class="token string">"from course, sc "</span></pre></td></tr><tr><td data-num="187"></td><td><pre>               <span class="token string">"where sc.cno = course.cno and sno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"' and time like '"</span> <span class="token operator">+</span> time <span class="token operator">+</span> <span class="token string">"' and property like '"</span> <span class="token operator">+</span> property <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="188"></td><td><pre></pre></td></tr><tr><td data-num="189"></td><td><pre></pre></td></tr><tr><td data-num="190"></td><td><pre>    ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">clearContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="191"></td><td><pre>    ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">setRowCount</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="192"></td><td><pre>    <span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="193"></td><td><pre>    <span class="token keyword">double</span> GPA <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> credit <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="194"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="195"></td><td><pre>        ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">insertRow</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="196"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">columnCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="197"></td><td><pre>            ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">setItem</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="198"></td><td><pre>            ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">item</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setTextAlignment</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>AlignCenter<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="199"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="200"></td><td><pre></pre></td></tr><tr><td data-num="201"></td><td><pre>        GPA <span class="token operator">+=</span> std<span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">10</span> <span class="token operator">*</span> query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="202"></td><td><pre>        credit <span class="token operator">+=</span> query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="203"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="204"></td><td><pre></pre></td></tr><tr><td data-num="205"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>credit<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="206"></td><td><pre>        ui<span class="token operator">-></span>GPA<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>GPA <span class="token operator">/</span> credit<span class="token punctuation">,</span> <span class="token char">'f'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="207"></td><td><pre>    <span class="token keyword">else</span> ui<span class="token operator">-></span>GPA<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"0.000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="208"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="209"></td><td><pre></pre></td></tr><tr><td data-num="210"></td><td><pre></pre></td></tr><tr><td data-num="211"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">StudentWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_Exit_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="212"></td><td><pre>    <span class="token keyword">this</span><span class="token operator">-></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="213"></td><td><pre>    emit <span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="214"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="215"></td><td><pre></pre></td></tr><tr><td data-num="216"></td><td><pre></pre></td></tr><tr><td data-num="217"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">StudentWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_My_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="218"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>ui<span class="token operator">-></span>Body<span class="token operator">-></span><span class="token function">currentIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="219"></td><td><pre>        ui<span class="token operator">-></span>Body<span class="token operator">-></span><span class="token function">setCurrentIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="220"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="221"></td><td><pre></pre></td></tr><tr><td data-num="222"></td><td><pre></pre></td></tr><tr><td data-num="223"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">StudentWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_Course_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="224"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>ui<span class="token operator">-></span>Body<span class="token operator">-></span><span class="token function">currentIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="225"></td><td><pre>        ui<span class="token operator">-></span>Body<span class="token operator">-></span><span class="token function">setCurrentIndex</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="226"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="227"></td><td><pre></pre></td></tr><tr><td data-num="228"></td><td><pre></pre></td></tr><tr><td data-num="229"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">StudentWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_Score_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="230"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>ui<span class="token operator">-></span>Body<span class="token operator">-></span><span class="token function">currentIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="231"></td><td><pre>        ui<span class="token operator">-></span>Body<span class="token operator">-></span><span class="token function">setCurrentIndex</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="232"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="233"></td><td><pre></pre></td></tr><tr><td data-num="234"></td><td><pre></pre></td></tr><tr><td data-num="235"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">StudentWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_Fee_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="236"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>ui<span class="token operator">-></span>Body<span class="token operator">-></span><span class="token function">currentIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="237"></td><td><pre>        ui<span class="token operator">-></span>Body<span class="token operator">-></span><span class="token function">setCurrentIndex</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="238"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="239"></td><td><pre></pre></td></tr><tr><td data-num="240"></td><td><pre></pre></td></tr><tr><td data-num="241"></td><td><pre><span class="token comment">//    QAction *searchAction = new QAction(ui->Search);</span></pre></td></tr><tr><td data-num="242"></td><td><pre><span class="token comment">//    searchAction->setIcon(QIcon(":/res/search.png"));</span></pre></td></tr><tr><td data-num="243"></td><td><pre><span class="token comment">//    ui->Search->addAction(searchAction, QLineEdit::LeadingPosition);</span></pre></td></tr><tr><td data-num="244"></td><td><pre></pre></td></tr><tr><td data-num="245"></td><td><pre><span class="token comment">// ======================================================================================= 初始化选课中心界面</span></pre></td></tr><tr><td data-num="246"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">StudentWindow</span><span class="token double-colon punctuation">::</span><span class="token function">init_SelectCourse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="247"></td><td><pre></pre></td></tr><tr><td data-num="248"></td><td><pre></pre></td></tr><tr><td data-num="249"></td><td><pre>    QStringList headerlist<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="250"></td><td><pre>    headerlist<span class="token operator">&lt;&lt;</span><span class="token string">"课程号"</span><span class="token operator">&lt;&lt;</span><span class="token string">"课程名"</span><span class="token operator">&lt;&lt;</span><span class="token string">"任课老师"</span><span class="token operator">&lt;&lt;</span><span class="token string">"开课学期"</span><span class="token operator">&lt;&lt;</span><span class="token string">"学时"</span><span class="token operator">&lt;&lt;</span><span class="token string">"学分"</span><span class="token operator">&lt;&lt;</span><span class="token string">"考核方式"</span><span class="token operator">&lt;&lt;</span><span class="token string">"课程属性"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="251"></td><td><pre>    ui<span class="token operator">-></span>ScoreTable_3<span class="token operator">-></span><span class="token function">setColumnCount</span><span class="token punctuation">(</span>headerlist<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="252"></td><td><pre>    ui<span class="token operator">-></span>ScoreTable_4<span class="token operator">-></span><span class="token function">setColumnCount</span><span class="token punctuation">(</span>headerlist<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="253"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ui<span class="token operator">-></span>ScoreTable_3<span class="token operator">-></span><span class="token function">columnCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="254"></td><td><pre>        ui<span class="token operator">-></span>ScoreTable_3<span class="token operator">-></span><span class="token function">setHorizontalHeaderItem</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>headerlist<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="255"></td><td><pre>        ui<span class="token operator">-></span>ScoreTable_4<span class="token operator">-></span><span class="token function">setHorizontalHeaderItem</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>headerlist<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="256"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="257"></td><td><pre>    ui<span class="token operator">-></span>ScoreTable_3<span class="token operator">-></span><span class="token function">horizontalHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setStyleSheet</span><span class="token punctuation">(</span><span class="token string">"QHeaderView::section&#123;font: Bold 13pt '微软雅黑'&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="258"></td><td><pre>    ui<span class="token operator">-></span>ScoreTable_4<span class="token operator">-></span><span class="token function">horizontalHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setStyleSheet</span><span class="token punctuation">(</span><span class="token string">"QHeaderView::section&#123;font: Bold 13pt '微软雅黑'&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="259"></td><td><pre>    ui<span class="token operator">-></span>ScoreTable_3<span class="token operator">-></span><span class="token function">horizontalHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setVisible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="260"></td><td><pre>    ui<span class="token operator">-></span>ScoreTable_4<span class="token operator">-></span><span class="token function">horizontalHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setVisible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="261"></td><td><pre>    ui<span class="token operator">-></span>ScoreTable_3<span class="token operator">-></span><span class="token function">setColumnCount</span><span class="token punctuation">(</span>headerlist<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="262"></td><td><pre>    ui<span class="token operator">-></span>ScoreTable_4<span class="token operator">-></span><span class="token function">setColumnCount</span><span class="token punctuation">(</span>headerlist<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="263"></td><td><pre></pre></td></tr><tr><td data-num="264"></td><td><pre>    <span class="token function">SelectCourseRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="265"></td><td><pre>    <span class="token function">SelectedCourseRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="266"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="267"></td><td><pre></pre></td></tr><tr><td data-num="268"></td><td><pre><span class="token comment">// ======================================================================================= 查找</span></pre></td></tr><tr><td data-num="269"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">StudentWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_SearchCourse_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="270"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="271"></td><td><pre>    QString cur_course <span class="token operator">=</span> ui<span class="token operator">-></span>Cname_2<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="272"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>cur_course <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="273"></td><td><pre>        <span class="token function">SelectCourseRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="274"></td><td><pre>        <span class="token keyword">return</span> <span class="token punctuation">;</span></pre></td></tr><tr><td data-num="275"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="276"></td><td><pre></pre></td></tr><tr><td data-num="277"></td><td><pre>    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="278"></td><td><pre>    <span class="token keyword">bool</span> k <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select cno, cname, tname, time, period, credit, assess, property "</span></pre></td></tr><tr><td data-num="279"></td><td><pre>                          <span class="token string">"from course, teacher "</span></pre></td></tr><tr><td data-num="280"></td><td><pre>                          <span class="token string">"where course.tno = teacher.tno and "</span></pre></td></tr><tr><td data-num="281"></td><td><pre>                          <span class="token string">"time = '"</span> <span class="token operator">+</span> Time <span class="token operator">+</span> <span class="token string">"' and "</span></pre></td></tr><tr><td data-num="282"></td><td><pre>                          <span class="token string">"cno = '"</span> <span class="token operator">+</span> cur_course <span class="token operator">+</span> <span class="token string">"' and "</span></pre></td></tr><tr><td data-num="283"></td><td><pre>                          <span class="token string">"cno &lt;>all( select cno "</span></pre></td></tr><tr><td data-num="284"></td><td><pre>                                      <span class="token string">"from sc "</span></pre></td></tr><tr><td data-num="285"></td><td><pre>                                      <span class="token string">"where sno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"' )"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="286"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="287"></td><td><pre>        ui<span class="token operator">-></span>ScoreTable_3<span class="token operator">-></span><span class="token function">clearContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="288"></td><td><pre>        <span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="289"></td><td><pre>        <span class="token keyword">while</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="290"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span>ui<span class="token operator">-></span>ScoreTable_3<span class="token operator">-></span><span class="token function">rowCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> row<span class="token punctuation">)</span>ui<span class="token operator">-></span>ScoreTable_3<span class="token operator">-></span><span class="token function">insertRow</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="291"></td><td><pre>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ui<span class="token operator">-></span>ScoreTable_3<span class="token operator">-></span><span class="token function">columnCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="292"></td><td><pre>                ui<span class="token operator">-></span>ScoreTable_3<span class="token operator">-></span><span class="token function">setItem</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="293"></td><td><pre>                ui<span class="token operator">-></span>ScoreTable_3<span class="token operator">-></span><span class="token function">item</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setTextAlignment</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>AlignCenter<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="294"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="295"></td><td><pre>            row<span class="token operator">++</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="296"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="297"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="298"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="299"></td><td><pre></pre></td></tr><tr><td data-num="300"></td><td><pre><span class="token comment">// ======================================================================================= 选课</span></pre></td></tr><tr><td data-num="301"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">StudentWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_SelectCourse_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="302"></td><td><pre>    QString cur_course <span class="token operator">=</span> ui<span class="token operator">-></span>Cname_2<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="303"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>cur_course <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="304"></td><td><pre>        <span class="token function">SelectCourseRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="305"></td><td><pre>        <span class="token keyword">return</span> <span class="token punctuation">;</span></pre></td></tr><tr><td data-num="306"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="307"></td><td><pre>    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="308"></td><td><pre>    <span class="token keyword">bool</span> k <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select cno, cname, tname, time, period, credit, assess, property "</span></pre></td></tr><tr><td data-num="309"></td><td><pre>                          <span class="token string">"from course, teacher "</span></pre></td></tr><tr><td data-num="310"></td><td><pre>                          <span class="token string">"where course.tno = teacher.tno and "</span></pre></td></tr><tr><td data-num="311"></td><td><pre>                          <span class="token string">"time = '"</span> <span class="token operator">+</span> Time <span class="token operator">+</span> <span class="token string">"' and "</span></pre></td></tr><tr><td data-num="312"></td><td><pre>                          <span class="token string">"cno = '"</span> <span class="token operator">+</span> cur_course <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="313"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="314"></td><td><pre>        query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="315"></td><td><pre>        QMessageBox box<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="316"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Question<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="317"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"选课中心"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="318"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/res/logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="319"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"确定选择课程："</span> <span class="token operator">+</span> cur_course <span class="token operator">+</span> <span class="token string">" 吗？"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="320"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setStandardButtons</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Yes <span class="token operator">|</span> QMessageBox<span class="token double-colon punctuation">::</span>No<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="321"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>box<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> QMessageBox<span class="token double-colon punctuation">::</span>Yes<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="322"></td><td><pre>            QSqlQuery t <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"insert into "</span></pre></td></tr><tr><td data-num="323"></td><td><pre>                                  <span class="token string">"sc (sno, cno, score)"</span></pre></td></tr><tr><td data-num="324"></td><td><pre>                                  <span class="token string">"values ( "</span></pre></td></tr><tr><td data-num="325"></td><td><pre>                                  <span class="token string">"'"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"', "</span></pre></td></tr><tr><td data-num="326"></td><td><pre>                                  <span class="token string">"'"</span> <span class="token operator">+</span> query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"', "</span></pre></td></tr><tr><td data-num="327"></td><td><pre>                                  <span class="token string">" 0 )"</span>   <span class="token comment">// 默认分数 0</span></pre></td></tr><tr><td data-num="328"></td><td><pre>                                  <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="329"></td><td><pre>            QMessageBox box_2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="330"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">isActive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="331"></td><td><pre>                box_2<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Information<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="332"></td><td><pre>                box_2<span class="token punctuation">.</span><span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/res/logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="333"></td><td><pre>                box_2<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"选课中心"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="334"></td><td><pre>                box_2<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"选课成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="335"></td><td><pre>                box_2<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="336"></td><td><pre>                <span class="token function">SelectCourseRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="337"></td><td><pre>                <span class="token function">SelectedCourseRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="338"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="339"></td><td><pre>            <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="340"></td><td><pre>                box_2<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Critical<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="341"></td><td><pre>                box_2<span class="token punctuation">.</span><span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/res/logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="342"></td><td><pre>                box_2<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"选课中心"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="343"></td><td><pre>                box_2<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"选课失败"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="344"></td><td><pre>                box_2<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="345"></td><td><pre>                <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>t<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="346"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="347"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="348"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="349"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="350"></td><td><pre></pre></td></tr><tr><td data-num="351"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">StudentWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_deleteCourse_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="352"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="353"></td><td><pre>    <span class="token keyword">int</span> currow<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="354"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>ui<span class="token operator">-></span>ScoreTable_4<span class="token operator">-></span><span class="token function">currentRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="355"></td><td><pre>        <span class="token keyword">return</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="356"></td><td><pre>    <span class="token keyword">else</span> currow <span class="token operator">=</span> ui<span class="token operator">-></span>ScoreTable_4<span class="token operator">-></span><span class="token function">currentRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="357"></td><td><pre>    <span class="token keyword">auto</span> current_item <span class="token operator">=</span> ui<span class="token operator">-></span>ScoreTable_4<span class="token operator">-></span><span class="token function">item</span><span class="token punctuation">(</span>currow<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="358"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>current_item <span class="token operator">==</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token keyword">return</span> <span class="token punctuation">;</span></pre></td></tr><tr><td data-num="359"></td><td><pre>    QString cur_course <span class="token operator">=</span> current_item<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="360"></td><td><pre>    QMessageBox box<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="361"></td><td><pre>    box<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Question<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="362"></td><td><pre>    box<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"选课中心"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="363"></td><td><pre>    box<span class="token punctuation">.</span><span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/res/logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="364"></td><td><pre>    box<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"确定删除课程："</span> <span class="token operator">+</span> cur_course <span class="token operator">+</span> <span class="token string">" 吗？"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="365"></td><td><pre>    box<span class="token punctuation">.</span><span class="token function">setStandardButtons</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Yes <span class="token operator">|</span> QMessageBox<span class="token double-colon punctuation">::</span>No<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="366"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>box<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> QMessageBox<span class="token double-colon punctuation">::</span>Yes<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="367"></td><td><pre>        QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="368"></td><td><pre>        query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"delete from sc "</span></pre></td></tr><tr><td data-num="369"></td><td><pre>                   <span class="token string">"where sno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"' and "</span></pre></td></tr><tr><td data-num="370"></td><td><pre>                         <span class="token string">"cno =all ( select cno "</span></pre></td></tr><tr><td data-num="371"></td><td><pre>                                    <span class="token string">"from course "</span></pre></td></tr><tr><td data-num="372"></td><td><pre>                                    <span class="token string">"where time = '"</span> <span class="token operator">+</span> Time <span class="token operator">+</span> <span class="token string">"' and "</span></pre></td></tr><tr><td data-num="373"></td><td><pre>                                           <span class="token string">"cno = '"</span> <span class="token operator">+</span> cur_course <span class="token operator">+</span> <span class="token string">"' )"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="374"></td><td><pre>        QMessageBox box_2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="375"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">isActive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="376"></td><td><pre>            box_2<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Information<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="377"></td><td><pre>            box_2<span class="token punctuation">.</span><span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/res/logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="378"></td><td><pre>            box_2<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"选课中心"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="379"></td><td><pre>            box_2<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"删除成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="380"></td><td><pre>            box_2<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="381"></td><td><pre>            <span class="token function">SelectCourseRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="382"></td><td><pre>            <span class="token function">SelectedCourseRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="383"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="384"></td><td><pre>        <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="385"></td><td><pre>            box_2<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Critical<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="386"></td><td><pre>            box_2<span class="token punctuation">.</span><span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/res/logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="387"></td><td><pre>            box_2<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"选课中心"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="388"></td><td><pre>            box_2<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"删除失败"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="389"></td><td><pre>            box_2<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="390"></td><td><pre>            <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>query<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="391"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="392"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="393"></td><td><pre></pre></td></tr><tr><td data-num="394"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="395"></td><td><pre></pre></td></tr><tr><td data-num="396"></td><td><pre><span class="token comment">// ======================================================================================= 刷新已选表</span></pre></td></tr><tr><td data-num="397"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">StudentWindow</span><span class="token double-colon punctuation">::</span><span class="token function">SelectedCourseRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="398"></td><td><pre>    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="399"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select course.cno, cname, tname, time, period, credit, assess, property "</span></pre></td></tr><tr><td data-num="400"></td><td><pre>               <span class="token string">"from course, teacher, sc "</span></pre></td></tr><tr><td data-num="401"></td><td><pre>               <span class="token string">"where sc.cno = course.cno and "</span></pre></td></tr><tr><td data-num="402"></td><td><pre>                     <span class="token string">"sc.sno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"' and "</span></pre></td></tr><tr><td data-num="403"></td><td><pre>                 <span class="token string">"course.tno = teacher.tno"</span></pre></td></tr><tr><td data-num="404"></td><td><pre>                        <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="405"></td><td><pre><span class="token comment">//    qDebug()&lt;&lt;query.lastError().text();</span></pre></td></tr><tr><td data-num="406"></td><td><pre>    ui<span class="token operator">-></span>ScoreTable_4<span class="token operator">-></span><span class="token function">clearContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="407"></td><td><pre>    <span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="408"></td><td><pre>    <span class="token keyword">while</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="409"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>ui<span class="token operator">-></span>ScoreTable_4<span class="token operator">-></span><span class="token function">rowCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> row<span class="token punctuation">)</span>ui<span class="token operator">-></span>ScoreTable_4<span class="token operator">-></span><span class="token function">insertRow</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="410"></td><td><pre>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ui<span class="token operator">-></span>ScoreTable_4<span class="token operator">-></span><span class="token function">columnCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="411"></td><td><pre>            ui<span class="token operator">-></span>ScoreTable_4<span class="token operator">-></span><span class="token function">setItem</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="412"></td><td><pre>            ui<span class="token operator">-></span>ScoreTable_4<span class="token operator">-></span><span class="token function">item</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setTextAlignment</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>AlignCenter<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="413"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="414"></td><td><pre>        row<span class="token operator">++</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="415"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="416"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="417"></td><td><pre></pre></td></tr><tr><td data-num="418"></td><td><pre><span class="token comment">// ======================================================================================= 刷新选课表</span></pre></td></tr><tr><td data-num="419"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">StudentWindow</span><span class="token double-colon punctuation">::</span><span class="token function">SelectCourseRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="420"></td><td><pre>    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="421"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select cno, cname, tname, time, period, credit, assess, property "</span></pre></td></tr><tr><td data-num="422"></td><td><pre>               <span class="token string">"from course, teacher "</span></pre></td></tr><tr><td data-num="423"></td><td><pre>               <span class="token string">"where course.tno = teacher.tno and "</span></pre></td></tr><tr><td data-num="424"></td><td><pre>                           <span class="token string">"time = '"</span> <span class="token operator">+</span> Time <span class="token operator">+</span> <span class="token string">"' and "</span></pre></td></tr><tr><td data-num="425"></td><td><pre>                           <span class="token string">"cno &lt;>all( select cno "</span></pre></td></tr><tr><td data-num="426"></td><td><pre>                                       <span class="token string">"from sc "</span></pre></td></tr><tr><td data-num="427"></td><td><pre>                                       <span class="token string">"where sno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"' )"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="428"></td><td><pre>    <span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="429"></td><td><pre>    ui<span class="token operator">-></span>ScoreTable_3<span class="token operator">-></span><span class="token function">clearContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="430"></td><td><pre>    <span class="token keyword">while</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="431"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>ui<span class="token operator">-></span>ScoreTable_3<span class="token operator">-></span><span class="token function">rowCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> row<span class="token punctuation">)</span>ui<span class="token operator">-></span>ScoreTable_3<span class="token operator">-></span><span class="token function">insertRow</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="432"></td><td><pre>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ui<span class="token operator">-></span>ScoreTable_3<span class="token operator">-></span><span class="token function">columnCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="433"></td><td><pre>            ui<span class="token operator">-></span>ScoreTable_3<span class="token operator">-></span><span class="token function">setItem</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="434"></td><td><pre>            ui<span class="token operator">-></span>ScoreTable_3<span class="token operator">-></span><span class="token function">item</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setTextAlignment</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>AlignCenter<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="435"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="436"></td><td><pre>        row<span class="token operator">++</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="437"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="438"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="439"></td><td><pre></pre></td></tr><tr><td data-num="440"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">StudentWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_ScoreTable_3_cellClicked</span><span class="token punctuation">(</span><span class="token keyword">int</span> row<span class="token punctuation">,</span> <span class="token keyword">int</span> column<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="441"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="442"></td><td><pre>    column <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="443"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>ui<span class="token operator">-></span>ScoreTable_3<span class="token operator">-></span><span class="token function">item</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> column<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="444"></td><td><pre>        ui<span class="token operator">-></span>Cname_2<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span>ui<span class="token operator">-></span>ScoreTable_3<span class="token operator">-></span><span class="token function">item</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> column<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="445"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="446"></td><td><pre></pre></td></tr><tr><td data-num="447"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">StudentWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_Search_7_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="448"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="449"></td><td><pre>    changePassword <span class="token operator">*</span> password <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">changePassword</span><span class="token punctuation">(</span>db<span class="token punctuation">,</span> username<span class="token punctuation">,</span> STUDENT<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="450"></td><td><pre>    password<span class="token operator">-></span><span class="token function">setWindowModality</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>ApplicationModal<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="451"></td><td><pre>    password<span class="token operator">-></span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="452"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="teacherwindowcpp"><a class="anchor" href="#teacherwindowcpp">#</a> teacherwindow.cpp</h2><figure class="highlight cpp"><figcaption data-lang="C++"><span>teacherwindow.cpp</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"teacherwindow.h"</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ui_teacherwindow.h"</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token class-name">TeacherWindow</span><span class="token double-colon punctuation">::</span><span class="token function">TeacherWindow</span><span class="token punctuation">(</span>QSqlDatabase db<span class="token punctuation">,</span> QString username<span class="token punctuation">,</span> QWidget <span class="token operator">*</span>parent<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">QMainWindow</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">ui</span><span class="token punctuation">(</span><span class="token keyword">new</span> Ui<span class="token double-colon punctuation">::</span>TeacherWindow<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    ui<span class="token operator">-></span><span class="token function">setupUi</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/res/logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                             <span class="token comment">// 设置窗口样式</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"江苏科技大学学生管理系统"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">this</span><span class="token operator">-></span><span class="token function">setStyleSheet</span><span class="token punctuation">(</span><span class="token string">"background-color: rgb(255, 255, 255);"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token function">resize</span><span class="token punctuation">(</span><span class="token number">1170</span><span class="token punctuation">,</span> <span class="token number">672</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>    QGraphicsDropShadowEffect <span class="token operator">*</span>shadow_effect <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">QGraphicsDropShadowEffect</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 侧边栏阴影效果</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    shadow_effect<span class="token operator">-></span><span class="token function">setOffset</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    shadow_effect<span class="token operator">-></span><span class="token function">setColor</span><span class="token punctuation">(</span><span class="token function">QColor</span><span class="token punctuation">(</span><span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">78</span><span class="token punctuation">,</span> <span class="token number">119</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    shadow_effect<span class="token operator">-></span><span class="token function">setBlurRadius</span><span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    ui<span class="token operator">-></span>Sidebar<span class="token operator">-></span><span class="token function">setGraphicsEffect</span><span class="token punctuation">(</span>shadow_effect<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre>    ui<span class="token operator">-></span>Body<span class="token operator">-></span><span class="token function">setCurrentIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                                       <span class="token comment">// 初始化第一个窗口和成员变量</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">this</span><span class="token operator">-></span>db <span class="token operator">=</span> db<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">this</span><span class="token operator">-></span>username <span class="token operator">=</span> username<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre>    ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">horizontalHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setSectionResizeMode</span><span class="token punctuation">(</span>QHeaderView<span class="token double-colon punctuation">::</span>Stretch<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 表格随窗口调整大小</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">horizontalHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setSectionResizeMode</span><span class="token punctuation">(</span>QHeaderView<span class="token double-colon punctuation">::</span>Stretch<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">horizontalHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setSectionResizeMode</span><span class="token punctuation">(</span>QHeaderView<span class="token double-colon punctuation">::</span>Stretch<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre>    ui<span class="token operator">-></span>Classno<span class="token operator">-></span><span class="token function">view</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setWindowFlags</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>Popup<span class="token operator">|</span>Qt<span class="token double-colon punctuation">::</span>FramelessWindowHint<span class="token operator">|</span>Qt<span class="token double-colon punctuation">::</span>NoDropShadowWindowHint<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    ui<span class="token operator">-></span>Classno<span class="token operator">-></span><span class="token function">view</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setAttribute</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>WA_TranslucentBackground<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// 下拉框圆角</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    ui<span class="token operator">-></span>Classno_2<span class="token operator">-></span><span class="token function">view</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setWindowFlags</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>Popup<span class="token operator">|</span>Qt<span class="token double-colon punctuation">::</span>FramelessWindowHint<span class="token operator">|</span>Qt<span class="token double-colon punctuation">::</span>NoDropShadowWindowHint<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    ui<span class="token operator">-></span>Classno_2<span class="token operator">-></span><span class="token function">view</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setAttribute</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>WA_TranslucentBackground<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    ui<span class="token operator">-></span>Cno<span class="token operator">-></span><span class="token function">view</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setWindowFlags</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>Popup<span class="token operator">|</span>Qt<span class="token double-colon punctuation">::</span>FramelessWindowHint<span class="token operator">|</span>Qt<span class="token double-colon punctuation">::</span>NoDropShadowWindowHint<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    ui<span class="token operator">-></span>Cno<span class="token operator">-></span><span class="token function">view</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setAttribute</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>WA_TranslucentBackground<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    ui<span class="token operator">-></span>Bednum<span class="token operator">-></span><span class="token function">view</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setWindowFlags</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>Popup<span class="token operator">|</span>Qt<span class="token double-colon punctuation">::</span>FramelessWindowHint<span class="token operator">|</span>Qt<span class="token double-colon punctuation">::</span>NoDropShadowWindowHint<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    ui<span class="token operator">-></span>Bednum<span class="token operator">-></span><span class="token function">view</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setAttribute</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>WA_TranslucentBackground<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    ui<span class="token operator">-></span>Bednum_2<span class="token operator">-></span><span class="token function">view</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setWindowFlags</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>Popup<span class="token operator">|</span>Qt<span class="token double-colon punctuation">::</span>FramelessWindowHint<span class="token operator">|</span>Qt<span class="token double-colon punctuation">::</span>NoDropShadowWindowHint<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    ui<span class="token operator">-></span>Bednum_2<span class="token operator">-></span><span class="token function">view</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setAttribute</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>WA_TranslucentBackground<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    ui<span class="token operator">-></span>Dorm<span class="token operator">-></span><span class="token function">view</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setWindowFlags</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>Popup<span class="token operator">|</span>Qt<span class="token double-colon punctuation">::</span>FramelessWindowHint<span class="token operator">|</span>Qt<span class="token double-colon punctuation">::</span>NoDropShadowWindowHint<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>    ui<span class="token operator">-></span>Dorm<span class="token operator">-></span><span class="token function">view</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setAttribute</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>WA_TranslucentBackground<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    ui<span class="token operator">-></span>Dorm_2<span class="token operator">-></span><span class="token function">view</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setWindowFlags</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>Popup<span class="token operator">|</span>Qt<span class="token double-colon punctuation">::</span>FramelessWindowHint<span class="token operator">|</span>Qt<span class="token double-colon punctuation">::</span>NoDropShadowWindowHint<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>    ui<span class="token operator">-></span>Dorm_2<span class="token operator">-></span><span class="token function">view</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setAttribute</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>WA_TranslucentBackground<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre></pre></td></tr><tr><td data-num="42"></td><td><pre>    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span>                                                                <span class="token comment">// 初始化下拉框选项</span></pre></td></tr><tr><td data-num="43"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select classno from class where tno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>        ui<span class="token operator">-></span>Classno<span class="token operator">-></span><span class="token function">addItem</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>        ui<span class="token operator">-></span>Classno_2<span class="token operator">-></span><span class="token function">addItem</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="48"></td><td><pre></pre></td></tr><tr><td data-num="49"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select cno from course where tno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>        ui<span class="token operator">-></span>Cno<span class="token operator">-></span><span class="token function">addItem</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="53"></td><td><pre></pre></td></tr><tr><td data-num="54"></td><td><pre>    <span class="token function">init_My</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                                                          <span class="token comment">// 调用初始化函数</span></pre></td></tr><tr><td data-num="55"></td><td><pre>    <span class="token function">init_Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>    <span class="token function">init_Score</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="57"></td><td><pre>    <span class="token function">init_Dorm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="58"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="59"></td><td><pre></pre></td></tr><tr><td data-num="60"></td><td><pre><span class="token class-name">TeacherWindow</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">TeacherWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="61"></td><td><pre>    <span class="token keyword">delete</span> ui<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="62"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="63"></td><td><pre></pre></td></tr><tr><td data-num="64"></td><td><pre><span class="token comment">// ======================================================================================= 初始化基本信息界面</span></pre></td></tr><tr><td data-num="65"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">TeacherWindow</span><span class="token double-colon punctuation">::</span><span class="token function">init_My</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="66"></td><td><pre>    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="67"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select tno, tname from teacher where tno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="68"></td><td><pre></pre></td></tr><tr><td data-num="69"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="70"></td><td><pre>    ui<span class="token operator">-></span>Tno<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="71"></td><td><pre>    ui<span class="token operator">-></span>Tname<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="72"></td><td><pre></pre></td></tr><tr><td data-num="73"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select major, classno from class where tno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="74"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> ui<span class="token operator">-></span>Class<span class="token operator">-></span><span class="token function">insertPlainText</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"("</span> <span class="token operator">+</span> query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="75"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="76"></td><td><pre>        ui<span class="token operator">-></span>Class<span class="token operator">-></span><span class="token function">insertPlainText</span><span class="token punctuation">(</span><span class="token string">"、"</span> <span class="token operator">+</span> query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"("</span> <span class="token operator">+</span> query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="77"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="78"></td><td><pre></pre></td></tr><tr><td data-num="79"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select cname, cno from course where tno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="80"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> ui<span class="token operator">-></span>Cname<span class="token operator">-></span><span class="token function">insertPlainText</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"("</span> <span class="token operator">+</span> query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="81"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="82"></td><td><pre>        ui<span class="token operator">-></span>Cname<span class="token operator">-></span><span class="token function">insertPlainText</span><span class="token punctuation">(</span><span class="token string">"、"</span> <span class="token operator">+</span> query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"("</span> <span class="token operator">+</span> query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="83"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="84"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="85"></td><td><pre></pre></td></tr><tr><td data-num="86"></td><td><pre><span class="token comment">// ======================================================================================= 初始化学生管理界面</span></pre></td></tr><tr><td data-num="87"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">TeacherWindow</span><span class="token double-colon punctuation">::</span><span class="token function">init_Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="88"></td><td><pre>    ui<span class="token operator">-></span>Search<span class="token operator">-></span><span class="token function">setPlaceholderText</span><span class="token punctuation">(</span><span class="token string">"请输入学号"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="89"></td><td><pre></pre></td></tr><tr><td data-num="90"></td><td><pre>    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="91"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select sno, sname, sex, age, status, student.major, phonenumber, jiangcheng "</span></pre></td></tr><tr><td data-num="92"></td><td><pre>               <span class="token string">"from student, class "</span></pre></td></tr><tr><td data-num="93"></td><td><pre>               <span class="token string">"where student.classno = class.classno and tno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="94"></td><td><pre></pre></td></tr><tr><td data-num="95"></td><td><pre></pre></td></tr><tr><td data-num="96"></td><td><pre>    QStringList headerlist<span class="token punctuation">;</span>   <span class="token comment">// 设置表头</span></pre></td></tr><tr><td data-num="97"></td><td><pre>    headerlist<span class="token operator">&lt;&lt;</span><span class="token string">"学号"</span><span class="token operator">&lt;&lt;</span><span class="token string">"姓名"</span><span class="token operator">&lt;&lt;</span><span class="token string">"性别"</span><span class="token operator">&lt;&lt;</span><span class="token string">"年龄"</span><span class="token operator">&lt;&lt;</span><span class="token string">"政治面貌"</span><span class="token operator">&lt;&lt;</span><span class="token string">"绩点"</span><span class="token operator">&lt;&lt;</span><span class="token string">"联系方式"</span><span class="token operator">&lt;&lt;</span><span class="token string">"奖惩"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="98"></td><td><pre>    ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">setColumnCount</span><span class="token punctuation">(</span>headerlist<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="99"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">columnCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="100"></td><td><pre>        ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">setHorizontalHeaderItem</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>headerlist<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="101"></td><td><pre></pre></td></tr><tr><td data-num="102"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="103"></td><td><pre>    ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">horizontalHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setStyleSheet</span><span class="token punctuation">(</span><span class="token string">"QHeaderView::section&#123;font: Bold 13pt '微软雅黑'&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="104"></td><td><pre>    ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">horizontalHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setVisible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="105"></td><td><pre></pre></td></tr><tr><td data-num="106"></td><td><pre>    <span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="107"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="108"></td><td><pre>        ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">insertRow</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="109"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">columnCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="110"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="111"></td><td><pre>                ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">setItem</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span><span class="token function">calculate_GPA</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="112"></td><td><pre>                ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">item</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setTextAlignment</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>AlignCenter<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="113"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="114"></td><td><pre>            <span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="115"></td><td><pre>                ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">setItem</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="116"></td><td><pre>                ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">item</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setTextAlignment</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>AlignCenter<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="117"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="118"></td><td><pre></pre></td></tr><tr><td data-num="119"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="120"></td><td><pre>        row<span class="token operator">++</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="121"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="122"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="123"></td><td><pre></pre></td></tr><tr><td data-num="124"></td><td><pre><span class="token comment">// ======================================================================================= 初始化成绩录入界面</span></pre></td></tr><tr><td data-num="125"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">TeacherWindow</span><span class="token double-colon punctuation">::</span><span class="token function">init_Score</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="126"></td><td><pre>    QString cno <span class="token operator">=</span> ui<span class="token operator">-></span>Cno<span class="token operator">-></span><span class="token function">currentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="127"></td><td><pre></pre></td></tr><tr><td data-num="128"></td><td><pre>    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="129"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select student.sno, sname, major, cname, score "</span></pre></td></tr><tr><td data-num="130"></td><td><pre>               <span class="token string">"from student, SC, course "</span></pre></td></tr><tr><td data-num="131"></td><td><pre>               <span class="token string">"where student.sno = SC.sno and course.cno = SC.cno and SC.cno = '"</span> <span class="token operator">+</span> cno <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="132"></td><td><pre></pre></td></tr><tr><td data-num="133"></td><td><pre>    QStringList headerlist<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="134"></td><td><pre>    headerlist<span class="token operator">&lt;&lt;</span><span class="token string">"学号"</span><span class="token operator">&lt;&lt;</span><span class="token string">"姓名"</span><span class="token operator">&lt;&lt;</span><span class="token string">"专业"</span><span class="token operator">&lt;&lt;</span><span class="token string">"课程名"</span><span class="token operator">&lt;&lt;</span><span class="token string">"成绩"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="135"></td><td><pre>    ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">setColumnCount</span><span class="token punctuation">(</span>headerlist<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="136"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">columnCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="137"></td><td><pre>        ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">setHorizontalHeaderItem</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>headerlist<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="138"></td><td><pre></pre></td></tr><tr><td data-num="139"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="140"></td><td><pre>    ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">horizontalHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setStyleSheet</span><span class="token punctuation">(</span><span class="token string">"QHeaderView::section&#123;font: Bold 13pt '微软雅黑'&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="141"></td><td><pre>    ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">horizontalHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setVisible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="142"></td><td><pre></pre></td></tr><tr><td data-num="143"></td><td><pre>    <span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="144"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="145"></td><td><pre>        ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">insertRow</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="146"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">columnCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="147"></td><td><pre>            ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">setItem</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="148"></td><td><pre>            ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">item</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setTextAlignment</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>AlignCenter<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="149"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">!=</span> <span class="token number">4</span><span class="token punctuation">)</span> ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">item</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setFlags</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>ItemIsEnabled<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 设置成绩列为可修改</span></pre></td></tr><tr><td data-num="150"></td><td><pre></pre></td></tr><tr><td data-num="151"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="152"></td><td><pre>        row<span class="token operator">++</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="153"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="154"></td><td><pre></pre></td></tr><tr><td data-num="155"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="156"></td><td><pre></pre></td></tr><tr><td data-num="157"></td><td><pre><span class="token comment">// ======================================================================================= 初始化宿舍管理界面</span></pre></td></tr><tr><td data-num="158"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">TeacherWindow</span><span class="token double-colon punctuation">::</span><span class="token function">init_Dorm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="159"></td><td><pre>    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="160"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select distinct dormitory "</span></pre></td></tr><tr><td data-num="161"></td><td><pre>               <span class="token string">"from student, class "</span></pre></td></tr><tr><td data-num="162"></td><td><pre>               <span class="token string">"where student.classno = class.classno and tno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="163"></td><td><pre></pre></td></tr><tr><td data-num="164"></td><td><pre>    QStringList headerlist<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="165"></td><td><pre>    headerlist<span class="token operator">&lt;&lt;</span><span class="token string">"宿舍号"</span><span class="token operator">&lt;&lt;</span><span class="token string">"1号床"</span><span class="token operator">&lt;&lt;</span><span class="token string">"2号床"</span><span class="token operator">&lt;&lt;</span><span class="token string">"3号床"</span><span class="token operator">&lt;&lt;</span><span class="token string">"4号床"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="166"></td><td><pre>    ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">setColumnCount</span><span class="token punctuation">(</span>headerlist<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="167"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">columnCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="168"></td><td><pre>        ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">setHorizontalHeaderItem</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>headerlist<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="169"></td><td><pre></pre></td></tr><tr><td data-num="170"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="171"></td><td><pre>    ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">horizontalHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setStyleSheet</span><span class="token punctuation">(</span><span class="token string">"QHeaderView::section&#123;font: Bold 13pt '微软雅黑'&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="172"></td><td><pre>    ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">horizontalHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setVisible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="173"></td><td><pre></pre></td></tr><tr><td data-num="174"></td><td><pre>    <span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="175"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="176"></td><td><pre>        ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">insertRow</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="177"></td><td><pre>        ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">setItem</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="178"></td><td><pre>        ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">item</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setTextAlignment</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>AlignCenter<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="179"></td><td><pre>        ui<span class="token operator">-></span>Dorm<span class="token operator">-></span><span class="token function">addItem</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="180"></td><td><pre>        ui<span class="token operator">-></span>Dorm_2<span class="token operator">-></span><span class="token function">addItem</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="181"></td><td><pre></pre></td></tr><tr><td data-num="182"></td><td><pre>        QSqlQuery <span class="token function">q</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="183"></td><td><pre>        q<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select sname, bednum from student where dormitory = '"</span> <span class="token operator">+</span> query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span>  <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="184"></td><td><pre></pre></td></tr><tr><td data-num="185"></td><td><pre>        <span class="token keyword">while</span> <span class="token punctuation">(</span>q<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="186"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">&lt;</span> q<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> q<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="187"></td><td><pre>                ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">setItem</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> q<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="188"></td><td><pre>                ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">item</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> q<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setTextAlignment</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>AlignCenter<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="189"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="190"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="191"></td><td><pre>        row<span class="token operator">++</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="192"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="193"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="194"></td><td><pre></pre></td></tr><tr><td data-num="195"></td><td><pre><span class="token comment">// ======================================================================================= 计算绩点</span></pre></td></tr><tr><td data-num="196"></td><td><pre>QString <span class="token class-name">TeacherWindow</span><span class="token double-colon punctuation">::</span><span class="token function">calculate_GPA</span><span class="token punctuation">(</span>QString Sno<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="197"></td><td><pre>    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="198"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select score, credit "</span></pre></td></tr><tr><td data-num="199"></td><td><pre>               <span class="token string">"from course, sc "</span></pre></td></tr><tr><td data-num="200"></td><td><pre>               <span class="token string">"where sc.cno = course.cno and sno = '"</span> <span class="token operator">+</span> Sno <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="201"></td><td><pre></pre></td></tr><tr><td data-num="202"></td><td><pre>    <span class="token keyword">double</span> GPA <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> credit <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="203"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="204"></td><td><pre>        GPA <span class="token operator">+=</span> std<span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">10</span> <span class="token operator">*</span> query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="205"></td><td><pre>        credit <span class="token operator">+=</span> query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="206"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="207"></td><td><pre></pre></td></tr><tr><td data-num="208"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>credit<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="209"></td><td><pre>        <span class="token keyword">return</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>GPA <span class="token operator">/</span> credit<span class="token punctuation">,</span> <span class="token char">'f'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="210"></td><td><pre></pre></td></tr><tr><td data-num="211"></td><td><pre>    <span class="token keyword">return</span> <span class="token string">"0.000"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="212"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="213"></td><td><pre></pre></td></tr><tr><td data-num="214"></td><td><pre><span class="token comment">// ======================================================================================= 修改按钮</span></pre></td></tr><tr><td data-num="215"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">TeacherWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_Modify_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="216"></td><td><pre>    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="217"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select sno "</span></pre></td></tr><tr><td data-num="218"></td><td><pre>               <span class="token string">"from student, class "</span></pre></td></tr><tr><td data-num="219"></td><td><pre>               <span class="token string">"where sno like '%"</span> <span class="token operator">+</span> ui<span class="token operator">-></span>Search<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"%' and student.classno = class.classno and tno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="220"></td><td><pre></pre></td></tr><tr><td data-num="221"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="222"></td><td><pre>        ModifyStudent <span class="token operator">*</span>modify <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ModifyStudent</span><span class="token punctuation">(</span>db<span class="token punctuation">,</span> query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> MODIFY<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="223"></td><td><pre>        modify<span class="token operator">-></span><span class="token function">setWindowModality</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>ApplicationModal<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="224"></td><td><pre>        modify<span class="token operator">-></span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="225"></td><td><pre></pre></td></tr><tr><td data-num="226"></td><td><pre>        <span class="token function">connect</span><span class="token punctuation">(</span>modify<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ModifyStudent<span class="token double-colon punctuation">::</span>update<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">=</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                           <span class="token comment">// 更新表格</span></pre></td></tr><tr><td data-num="227"></td><td><pre>            <span class="token comment">//init_Student();</span></pre></td></tr><tr><td data-num="228"></td><td><pre>            <span class="token function">on_Classno_currentTextChanged</span><span class="token punctuation">(</span>ui<span class="token operator">-></span>Classno<span class="token operator">-></span><span class="token function">currentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="229"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="230"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="231"></td><td><pre>    <span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="232"></td><td><pre>        QMessageBox box<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="233"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Warning<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="234"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/res/logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="235"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"警告"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="236"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"未找到该学生"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="237"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="238"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="239"></td><td><pre></pre></td></tr><tr><td data-num="240"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="241"></td><td><pre></pre></td></tr><tr><td data-num="242"></td><td><pre><span class="token comment">// ======================================================================================= 选择班级下拉框</span></pre></td></tr><tr><td data-num="243"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">TeacherWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Classno_currentTextChanged</span><span class="token punctuation">(</span><span class="token keyword">const</span> QString <span class="token operator">&amp;</span>arg1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="244"></td><td><pre>    <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> arg1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="245"></td><td><pre></pre></td></tr><tr><td data-num="246"></td><td><pre>    QString classno <span class="token operator">=</span> arg1 <span class="token operator">==</span> <span class="token string">"全部"</span> <span class="token operator">?</span> <span class="token string">"%"</span> <span class="token operator">:</span> arg1<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="247"></td><td><pre></pre></td></tr><tr><td data-num="248"></td><td><pre>    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="249"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select sno, sname, sex, age, status, student.major, phonenumber, jiangcheng "</span></pre></td></tr><tr><td data-num="250"></td><td><pre>               <span class="token string">"from student, class "</span></pre></td></tr><tr><td data-num="251"></td><td><pre>               <span class="token string">"where student.classno = class.classno and tno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"' and student.classno like '"</span> <span class="token operator">+</span> classno <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="252"></td><td><pre></pre></td></tr><tr><td data-num="253"></td><td><pre>    ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">setSortingEnabled</span> <span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                        <span class="token comment">// 解决关于排序后查询错乱的问题</span></pre></td></tr><tr><td data-num="254"></td><td><pre>    ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">clearContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="255"></td><td><pre>    ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">setRowCount</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="256"></td><td><pre>    <span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="257"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="258"></td><td><pre>        ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">insertRow</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="259"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">columnCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="260"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="261"></td><td><pre>                ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">setItem</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span><span class="token function">calculate_GPA</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="262"></td><td><pre>            <span class="token keyword">else</span></pre></td></tr><tr><td data-num="263"></td><td><pre>                ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">setItem</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="264"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="265"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="266"></td><td><pre>    ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">setSortingEnabled</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="267"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="268"></td><td><pre></pre></td></tr><tr><td data-num="269"></td><td><pre><span class="token comment">// ======================================================================================= 查询按钮</span></pre></td></tr><tr><td data-num="270"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">TeacherWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_Search_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="271"></td><td><pre>    QString classno <span class="token operator">=</span> ui<span class="token operator">-></span>Classno<span class="token operator">-></span><span class="token function">currentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"全部"</span> <span class="token operator">?</span> <span class="token string">"%"</span> <span class="token operator">:</span> ui<span class="token operator">-></span>Classno<span class="token operator">-></span><span class="token function">currentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="272"></td><td><pre></pre></td></tr><tr><td data-num="273"></td><td><pre>    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="274"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select sno, sname, sex, age, status, student.major, phonenumber, jiangcheng "</span></pre></td></tr><tr><td data-num="275"></td><td><pre>               <span class="token string">"from student, class "</span></pre></td></tr><tr><td data-num="276"></td><td><pre>               <span class="token string">"where student.classno = class.classno and tno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"' "</span></pre></td></tr><tr><td data-num="277"></td><td><pre>                     <span class="token string">"and student.classno like '"</span> <span class="token operator">+</span> classno <span class="token operator">+</span> <span class="token string">"' and sno like '%"</span> <span class="token operator">+</span> ui<span class="token operator">-></span>Search<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"%'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="278"></td><td><pre></pre></td></tr><tr><td data-num="279"></td><td><pre>    ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">setSortingEnabled</span> <span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                        <span class="token comment">// 解决关于排序后查询错乱的问题</span></pre></td></tr><tr><td data-num="280"></td><td><pre>    ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">clearContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                                  <span class="token comment">// 清空表</span></pre></td></tr><tr><td data-num="281"></td><td><pre>    ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">setRowCount</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="282"></td><td><pre>    <span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="283"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="284"></td><td><pre>        ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">insertRow</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="285"></td><td><pre>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">columnCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="286"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="287"></td><td><pre>                ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">setItem</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span><span class="token function">calculate_GPA</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="288"></td><td><pre>                ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">item</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setTextAlignment</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>AlignCenter<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="289"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="290"></td><td><pre>            <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="291"></td><td><pre>                ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">setItem</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="292"></td><td><pre>                ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">item</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setTextAlignment</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>AlignCenter<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="293"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="294"></td><td><pre></pre></td></tr><tr><td data-num="295"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="296"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="297"></td><td><pre>    ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">setSortingEnabled</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="298"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="299"></td><td><pre></pre></td></tr><tr><td data-num="300"></td><td><pre><span class="token comment">// ======================================================================================= 保存按钮</span></pre></td></tr><tr><td data-num="301"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">TeacherWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_Save_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="302"></td><td><pre>    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="303"></td><td><pre>    <span class="token keyword">bool</span> k <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="304"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">rowCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="305"></td><td><pre>        k <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"update SC set score = '"</span> <span class="token operator">+</span> ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">item</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"' "</span></pre></td></tr><tr><td data-num="306"></td><td><pre>                        <span class="token string">"where sno = '"</span> <span class="token operator">+</span> ui<span class="token operator">-></span>ScoreTable<span class="token operator">-></span><span class="token function">item</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="307"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="308"></td><td><pre>    QMessageBox box<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="309"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="310"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Information<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="311"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/res/logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="312"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"保存"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="313"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"保存成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="314"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="315"></td><td><pre>    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="316"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Critical<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="317"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/res/logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="318"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"警告"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="319"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"保存失败"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="320"></td><td><pre>        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>query<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="321"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="322"></td><td><pre>    box<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="323"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="324"></td><td><pre></pre></td></tr><tr><td data-num="325"></td><td><pre><span class="token comment">// ======================================================================================= 交换宿舍按钮</span></pre></td></tr><tr><td data-num="326"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">TeacherWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_Exchange_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="327"></td><td><pre>    QString dorm <span class="token operator">=</span> ui<span class="token operator">-></span>Dorm<span class="token operator">-></span><span class="token function">currentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="328"></td><td><pre>    QString bednum <span class="token operator">=</span> ui<span class="token operator">-></span>Bednum<span class="token operator">-></span><span class="token function">currentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="329"></td><td><pre>    QString dorm_2 <span class="token operator">=</span> ui<span class="token operator">-></span>Dorm_2<span class="token operator">-></span><span class="token function">currentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="330"></td><td><pre>    QString bednum_2 <span class="token operator">=</span> ui<span class="token operator">-></span>Bednum_2<span class="token operator">-></span><span class="token function">currentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="331"></td><td><pre></pre></td></tr><tr><td data-num="332"></td><td><pre>    QString sex1 <span class="token operator">=</span> ui<span class="token operator">-></span>Boy<span class="token operator">-></span><span class="token function">isChecked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">"无"</span><span class="token operator">:</span> <span class="token string">"男"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="333"></td><td><pre>    QString sex2 <span class="token operator">=</span> ui<span class="token operator">-></span>Gril<span class="token operator">-></span><span class="token function">isChecked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">"无"</span><span class="token operator">:</span> <span class="token string">"女"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="334"></td><td><pre></pre></td></tr><tr><td data-num="335"></td><td><pre>    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="336"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"update student set dormitory = '0-A000', bednum = 0 "</span></pre></td></tr><tr><td data-num="337"></td><td><pre>               <span class="token string">"where dormitory = '"</span> <span class="token operator">+</span> dorm <span class="token operator">+</span> <span class="token string">"' and bednum = '"</span> <span class="token operator">+</span> bednum <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="338"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"update student set dormitory = '"</span> <span class="token operator">+</span> dorm <span class="token operator">+</span> <span class="token string">"', bednum = '"</span> <span class="token operator">+</span> bednum <span class="token operator">+</span> <span class="token string">"' "</span></pre></td></tr><tr><td data-num="339"></td><td><pre>               <span class="token string">"where dormitory = '"</span> <span class="token operator">+</span> dorm_2 <span class="token operator">+</span> <span class="token string">"' and bednum = '"</span> <span class="token operator">+</span> bednum_2 <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="340"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"update student set dormitory = '"</span> <span class="token operator">+</span> dorm_2 <span class="token operator">+</span> <span class="token string">"', bednum = '"</span> <span class="token operator">+</span> bednum_2 <span class="token operator">+</span> <span class="token string">"' "</span></pre></td></tr><tr><td data-num="341"></td><td><pre>               <span class="token string">"where dormitory = '0-A000' and bednum = 0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="342"></td><td><pre></pre></td></tr><tr><td data-num="343"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select distinct dormitory "</span></pre></td></tr><tr><td data-num="344"></td><td><pre>               <span class="token string">"from student, class "</span></pre></td></tr><tr><td data-num="345"></td><td><pre>               <span class="token string">"where student.classno = class.classno and tno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"' and sex &lt;> '"</span> <span class="token operator">+</span> sex1 <span class="token operator">+</span> <span class="token string">"' and sex &lt;> '"</span> <span class="token operator">+</span> sex2 <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="346"></td><td><pre></pre></td></tr><tr><td data-num="347"></td><td><pre>    ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">setSortingEnabled</span> <span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                        <span class="token comment">// 解决关于排序后查询错乱的问题</span></pre></td></tr><tr><td data-num="348"></td><td><pre>    ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">clearContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                                  <span class="token comment">// 清空表</span></pre></td></tr><tr><td data-num="349"></td><td><pre>    ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">setRowCount</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="350"></td><td><pre>    <span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="351"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="352"></td><td><pre>        ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">insertRow</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="353"></td><td><pre>        ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">setItem</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="354"></td><td><pre>        ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">item</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setTextAlignment</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>AlignCenter<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="355"></td><td><pre>        QSqlQuery <span class="token function">q</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="356"></td><td><pre>        q<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select sname, bednum from student where dormitory = '"</span> <span class="token operator">+</span> query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span>  <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="357"></td><td><pre></pre></td></tr><tr><td data-num="358"></td><td><pre>        <span class="token keyword">while</span> <span class="token punctuation">(</span>q<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="359"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">&lt;</span> q<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> q<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="360"></td><td><pre>                ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">setItem</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> q<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="361"></td><td><pre>                ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">item</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> q<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setTextAlignment</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>AlignCenter<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="362"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="363"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="364"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="365"></td><td><pre>    ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">setSortingEnabled</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="366"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="367"></td><td><pre></pre></td></tr><tr><td data-num="368"></td><td><pre><span class="token comment">// ======================================================================================= 筛选 - 男</span></pre></td></tr><tr><td data-num="369"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">TeacherWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Boy_stateChanged</span><span class="token punctuation">(</span><span class="token keyword">int</span> arg1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="370"></td><td><pre>    QString sex1 <span class="token operator">=</span> arg1 <span class="token operator">?</span> <span class="token string">"无"</span><span class="token operator">:</span> <span class="token string">"男"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="371"></td><td><pre>    QString sex2 <span class="token operator">=</span> ui<span class="token operator">-></span>Gril<span class="token operator">-></span><span class="token function">isChecked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">"无"</span><span class="token operator">:</span> <span class="token string">"女"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="372"></td><td><pre></pre></td></tr><tr><td data-num="373"></td><td><pre>    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="374"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select distinct dormitory "</span></pre></td></tr><tr><td data-num="375"></td><td><pre>               <span class="token string">"from student, class "</span></pre></td></tr><tr><td data-num="376"></td><td><pre>               <span class="token string">"where student.classno = class.classno and tno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"' and sex &lt;> '"</span> <span class="token operator">+</span> sex1 <span class="token operator">+</span> <span class="token string">"' and sex &lt;> '"</span> <span class="token operator">+</span> sex2 <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="377"></td><td><pre></pre></td></tr><tr><td data-num="378"></td><td><pre>    ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">setSortingEnabled</span> <span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                        <span class="token comment">// 解决关于排序后查询错乱的问题</span></pre></td></tr><tr><td data-num="379"></td><td><pre>    ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">clearContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                                  <span class="token comment">// 清空表</span></pre></td></tr><tr><td data-num="380"></td><td><pre>    ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">setRowCount</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="381"></td><td><pre>    <span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="382"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="383"></td><td><pre>        ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">insertRow</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="384"></td><td><pre>        ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">setItem</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="385"></td><td><pre>        ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">item</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setTextAlignment</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>AlignCenter<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="386"></td><td><pre>        QSqlQuery <span class="token function">q</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="387"></td><td><pre>        q<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select sname, bednum from student where dormitory = '"</span> <span class="token operator">+</span> query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span>  <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="388"></td><td><pre></pre></td></tr><tr><td data-num="389"></td><td><pre>        <span class="token keyword">while</span> <span class="token punctuation">(</span>q<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="390"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">&lt;</span> q<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> q<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="391"></td><td><pre>                ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">setItem</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> q<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="392"></td><td><pre>                ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">item</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> q<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setTextAlignment</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>AlignCenter<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="393"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="394"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="395"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="396"></td><td><pre>    ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">setSortingEnabled</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="397"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="398"></td><td><pre></pre></td></tr><tr><td data-num="399"></td><td><pre><span class="token comment">// ======================================================================================= 筛选 - 女</span></pre></td></tr><tr><td data-num="400"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">TeacherWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Gril_stateChanged</span><span class="token punctuation">(</span><span class="token keyword">int</span> arg1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="401"></td><td><pre>    QString sex1 <span class="token operator">=</span> ui<span class="token operator">-></span>Boy<span class="token operator">-></span><span class="token function">isChecked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">"无"</span><span class="token operator">:</span> <span class="token string">"男"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="402"></td><td><pre>    QString sex2 <span class="token operator">=</span> arg1 <span class="token operator">?</span> <span class="token string">"无"</span><span class="token operator">:</span> <span class="token string">"女"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="403"></td><td><pre></pre></td></tr><tr><td data-num="404"></td><td><pre>    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="405"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select distinct dormitory "</span></pre></td></tr><tr><td data-num="406"></td><td><pre>               <span class="token string">"from student, class "</span></pre></td></tr><tr><td data-num="407"></td><td><pre>               <span class="token string">"where student.classno = class.classno and tno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"' and sex &lt;> '"</span> <span class="token operator">+</span> sex1 <span class="token operator">+</span> <span class="token string">"' and sex &lt;> '"</span> <span class="token operator">+</span> sex2 <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="408"></td><td><pre></pre></td></tr><tr><td data-num="409"></td><td><pre>    ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">setSortingEnabled</span> <span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                        <span class="token comment">// 解决关于排序后查询错乱的问题</span></pre></td></tr><tr><td data-num="410"></td><td><pre>    ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">clearContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                                  <span class="token comment">// 清空表</span></pre></td></tr><tr><td data-num="411"></td><td><pre>    ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">setRowCount</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="412"></td><td><pre>    <span class="token keyword">int</span> row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="413"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="414"></td><td><pre>        ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">insertRow</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="415"></td><td><pre>        ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">setItem</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="416"></td><td><pre>        ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">item</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setTextAlignment</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>AlignCenter<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="417"></td><td><pre>        QSqlQuery <span class="token function">q</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="418"></td><td><pre>        q<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select sname, bednum from student where dormitory = '"</span> <span class="token operator">+</span> query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span>  <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="419"></td><td><pre></pre></td></tr><tr><td data-num="420"></td><td><pre>        <span class="token keyword">while</span> <span class="token punctuation">(</span>q<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="421"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">&lt;</span> q<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> q<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="422"></td><td><pre>                ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">setItem</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> q<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">QTableWidgetItem</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="423"></td><td><pre>                ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">item</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> q<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">setTextAlignment</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>AlignCenter<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="424"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="425"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="426"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="427"></td><td><pre>    ui<span class="token operator">-></span>DormTable<span class="token operator">-></span><span class="token function">setSortingEnabled</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="428"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="429"></td><td><pre></pre></td></tr><tr><td data-num="430"></td><td><pre></pre></td></tr><tr><td data-num="431"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">TeacherWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_My_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="432"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>ui<span class="token operator">-></span>Body<span class="token operator">-></span><span class="token function">currentIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="433"></td><td><pre>        ui<span class="token operator">-></span>Body<span class="token operator">-></span><span class="token function">setCurrentIndex</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="434"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="435"></td><td><pre></pre></td></tr><tr><td data-num="436"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">TeacherWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_Student_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="437"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>ui<span class="token operator">-></span>Body<span class="token operator">-></span><span class="token function">currentIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="438"></td><td><pre>        ui<span class="token operator">-></span>Body<span class="token operator">-></span><span class="token function">setCurrentIndex</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="439"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="440"></td><td><pre></pre></td></tr><tr><td data-num="441"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">TeacherWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_Score_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="442"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>ui<span class="token operator">-></span>Body<span class="token operator">-></span><span class="token function">currentIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="443"></td><td><pre>        ui<span class="token operator">-></span>Body<span class="token operator">-></span><span class="token function">setCurrentIndex</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="444"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="445"></td><td><pre></pre></td></tr><tr><td data-num="446"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">TeacherWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_Dorm_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="447"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>ui<span class="token operator">-></span>Body<span class="token operator">-></span><span class="token function">currentIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="448"></td><td><pre>        ui<span class="token operator">-></span>Body<span class="token operator">-></span><span class="token function">setCurrentIndex</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="449"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="450"></td><td><pre></pre></td></tr><tr><td data-num="451"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">TeacherWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_Exit_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="452"></td><td><pre>    <span class="token keyword">this</span><span class="token operator">-></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="453"></td><td><pre>    emit <span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="454"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="455"></td><td><pre></pre></td></tr><tr><td data-num="456"></td><td><pre><span class="token comment">// ======================================================================================= 新增按钮</span></pre></td></tr><tr><td data-num="457"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">TeacherWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_Add_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="458"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="459"></td><td><pre>    ModifyStudent <span class="token operator">*</span>modify <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ModifyStudent</span><span class="token punctuation">(</span>db<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> ADD<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="460"></td><td><pre>    modify<span class="token operator">-></span><span class="token function">setWindowModality</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>ApplicationModal<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="461"></td><td><pre>    modify<span class="token operator">-></span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="462"></td><td><pre></pre></td></tr><tr><td data-num="463"></td><td><pre>    <span class="token function">connect</span><span class="token punctuation">(</span>modify<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ModifyStudent<span class="token double-colon punctuation">::</span>update<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">=</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                           <span class="token comment">// 更新表格</span></pre></td></tr><tr><td data-num="464"></td><td><pre>        <span class="token comment">//init_Student();</span></pre></td></tr><tr><td data-num="465"></td><td><pre>        <span class="token function">on_Classno_currentTextChanged</span><span class="token punctuation">(</span>ui<span class="token operator">-></span>Classno<span class="token operator">-></span><span class="token function">currentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="466"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="467"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="468"></td><td><pre></pre></td></tr><tr><td data-num="469"></td><td><pre></pre></td></tr><tr><td data-num="470"></td><td><pre><span class="token comment">// ======================================================================================= 统计按钮</span></pre></td></tr><tr><td data-num="471"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">TeacherWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_stat_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="472"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="473"></td><td><pre>    QString cno <span class="token operator">=</span> ui<span class="token operator">-></span>Cno<span class="token operator">-></span><span class="token function">currentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="474"></td><td><pre>    Statics <span class="token operator">*</span>statics <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Statics</span><span class="token punctuation">(</span>db<span class="token punctuation">,</span> cno<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="475"></td><td><pre>    statics<span class="token operator">-></span><span class="token function">setWindowModality</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>ApplicationModal<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="476"></td><td><pre>    statics<span class="token operator">-></span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="477"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="478"></td><td><pre></pre></td></tr><tr><td data-num="479"></td><td><pre><span class="token comment">// ======================================================================================= 删除按钮</span></pre></td></tr><tr><td data-num="480"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">TeacherWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_Delete_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="481"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="482"></td><td><pre>    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="483"></td><td><pre>    <span class="token keyword">bool</span> k <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select sno "</span></pre></td></tr><tr><td data-num="484"></td><td><pre>               <span class="token string">"from student, class "</span></pre></td></tr><tr><td data-num="485"></td><td><pre>               <span class="token string">"where sno like "</span> <span class="token operator">+</span> ui<span class="token operator">-></span>Search<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" and student.classno = class.classno and tno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="486"></td><td><pre>                <span class="token comment">// 取消模糊查找</span></pre></td></tr><tr><td data-num="487"></td><td><pre></pre></td></tr><tr><td data-num="488"></td><td><pre>    QMessageBox box<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="489"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="490"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Question<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="491"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/res/logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="492"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"警告"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="493"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"确定删除该学生的记录吗？"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="494"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setStandardButtons</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Yes <span class="token operator">|</span> QMessageBox<span class="token double-colon punctuation">::</span>No<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="495"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>box<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> QMessageBox<span class="token double-colon punctuation">::</span>Yes<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="496"></td><td><pre>            QSqlQuery t <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"delete "</span></pre></td></tr><tr><td data-num="497"></td><td><pre>                                  <span class="token string">"from student "</span></pre></td></tr><tr><td data-num="498"></td><td><pre>                                  <span class="token string">"where sno = "</span><span class="token operator">+</span> ui<span class="token operator">-></span>Search<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="499"></td><td><pre>            QMessageBox box_2<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="500"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">isActive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="501"></td><td><pre>                box_2<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Information<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="502"></td><td><pre>                box_2<span class="token punctuation">.</span><span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/res/logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="503"></td><td><pre>                box_2<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"学生管理"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="504"></td><td><pre>                box_2<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"记录已删除"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="505"></td><td><pre>                box_2<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="506"></td><td><pre>                db<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="507"></td><td><pre>                <span class="token function">on_Classno_currentTextChanged</span><span class="token punctuation">(</span>ui<span class="token operator">-></span>Classno<span class="token operator">-></span><span class="token function">currentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="508"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="509"></td><td><pre>            <span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="510"></td><td><pre>                box_2<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Critical<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="511"></td><td><pre>                box_2<span class="token punctuation">.</span><span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/res/logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="512"></td><td><pre>                box_2<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"警告"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="513"></td><td><pre>                box_2<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"删除失败"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="514"></td><td><pre>                box_2<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="515"></td><td><pre>                <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>t<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="516"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="517"></td><td><pre></pre></td></tr><tr><td data-num="518"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="519"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="520"></td><td><pre>    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="521"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Warning<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="522"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/res/logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="523"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"警告"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="524"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"无效的记录"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="525"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="526"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="527"></td><td><pre></pre></td></tr><tr><td data-num="528"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="529"></td><td><pre></pre></td></tr><tr><td data-num="530"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">TeacherWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_StudentTable_cellClicked</span><span class="token punctuation">(</span><span class="token keyword">int</span> row<span class="token punctuation">,</span> <span class="token keyword">int</span> column<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="531"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="532"></td><td><pre>    column <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="533"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">item</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> column<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="534"></td><td><pre>        ui<span class="token operator">-></span>Search<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span>ui<span class="token operator">-></span>StudentTable<span class="token operator">-></span><span class="token function">item</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> column<span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="535"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="536"></td><td><pre></pre></td></tr><tr><td data-num="537"></td><td><pre><span class="token comment">// ======================================================================================= 修改密码</span></pre></td></tr><tr><td data-num="538"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">TeacherWindow</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_Search_7_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="539"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="540"></td><td><pre>    changePassword <span class="token operator">*</span> password <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">changePassword</span><span class="token punctuation">(</span>db<span class="token punctuation">,</span> username<span class="token punctuation">,</span> TEACHER<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="541"></td><td><pre>    password<span class="token operator">-></span><span class="token function">setWindowModality</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>ApplicationModal<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="542"></td><td><pre>    password<span class="token operator">-></span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="543"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="modifystudentcpp"><a class="anchor" href="#modifystudentcpp">#</a> modifystudent.cpp</h2><figure class="highlight cpp"><figcaption data-lang="C++"><span>modifystudent.cpp</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"modifystudent.h"</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ui_modifystudent.h"</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token class-name">ModifyStudent</span><span class="token double-colon punctuation">::</span><span class="token function">ModifyStudent</span><span class="token punctuation">(</span>QSqlDatabase db<span class="token punctuation">,</span> QString username<span class="token punctuation">,</span> <span class="token keyword">int</span> model<span class="token punctuation">,</span> QWidget <span class="token operator">*</span>parent<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">QMainWindow</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">ui</span><span class="token punctuation">(</span><span class="token keyword">new</span> Ui<span class="token double-colon punctuation">::</span>ModifyStudent<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    ui<span class="token operator">-></span><span class="token function">setupUi</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token function">setWindowFlags</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>CustomizeWindowHint<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 隐藏标题栏</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token function">setFixedSize</span><span class="token punctuation">(</span><span class="token number">630</span><span class="token punctuation">,</span> <span class="token number">420</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">this</span><span class="token operator">-></span>db <span class="token operator">=</span> db<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>    Model <span class="token operator">=</span> model<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>Model <span class="token operator">==</span> MODIFY<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token keyword">this</span><span class="token operator">-></span>username <span class="token operator">=</span> username<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token class-name">ModifyStudent</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">ModifyStudent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">delete</span> ui<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">ModifyStudent</span><span class="token double-colon punctuation">::</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select sno, sname, sex, age, major, classno, status, phonenumber, jiangcheng "</span></pre></td></tr><tr><td data-num="27"></td><td><pre>               <span class="token string">"from student "</span></pre></td></tr><tr><td data-num="28"></td><td><pre>               <span class="token string">"where sno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre></pre></td></tr><tr><td data-num="30"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    ui<span class="token operator">-></span>Sno<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    ui<span class="token operator">-></span>Sname<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    ui<span class="token operator">-></span>Sex<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    ui<span class="token operator">-></span>Age<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    ui<span class="token operator">-></span>Major<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    ui<span class="token operator">-></span>Classno<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    ui<span class="token operator">-></span>Status<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>    ui<span class="token operator">-></span>Phonenumber<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    ui<span class="token operator">-></span>Jiangcheng<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="41"></td><td><pre></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">ModifyStudent</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_Cancel_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>    <span class="token keyword">this</span><span class="token operator">-></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="45"></td><td><pre></pre></td></tr><tr><td data-num="46"></td><td><pre></pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">ModifyStudent</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_Save_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre></pre></td></tr><tr><td data-num="50"></td><td><pre>    <span class="token keyword">switch</span><span class="token punctuation">(</span>Model<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>    <span class="token keyword">case</span> MODIFY<span class="token operator">:</span></pre></td></tr><tr><td data-num="52"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>        <span class="token keyword">bool</span> k <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"update student "</span></pre></td></tr><tr><td data-num="54"></td><td><pre>                            <span class="token string">"set sno = '"</span> <span class="token operator">+</span> ui<span class="token operator">-></span>Sno<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"', "</span></pre></td></tr><tr><td data-num="55"></td><td><pre>                                <span class="token string">"sname = '"</span> <span class="token operator">+</span> ui<span class="token operator">-></span>Sname<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"', "</span></pre></td></tr><tr><td data-num="56"></td><td><pre>                                <span class="token string">"sex = '"</span> <span class="token operator">+</span> ui<span class="token operator">-></span>Sex<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"', "</span></pre></td></tr><tr><td data-num="57"></td><td><pre>                                <span class="token string">"age = '"</span> <span class="token operator">+</span> ui<span class="token operator">-></span>Age<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"', "</span></pre></td></tr><tr><td data-num="58"></td><td><pre>                                <span class="token string">"major = '"</span> <span class="token operator">+</span> ui<span class="token operator">-></span>Major<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"', "</span></pre></td></tr><tr><td data-num="59"></td><td><pre>                                <span class="token string">"classno = '"</span> <span class="token operator">+</span> ui<span class="token operator">-></span>Classno<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"', "</span></pre></td></tr><tr><td data-num="60"></td><td><pre>                                <span class="token string">"status = '"</span> <span class="token operator">+</span> ui<span class="token operator">-></span>Status<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"', "</span></pre></td></tr><tr><td data-num="61"></td><td><pre>                                <span class="token string">"phonenumber = '"</span> <span class="token operator">+</span> ui<span class="token operator">-></span>Phonenumber<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"', "</span></pre></td></tr><tr><td data-num="62"></td><td><pre>                                <span class="token string">"jiangcheng = '"</span> <span class="token operator">+</span> ui<span class="token operator">-></span>Jiangcheng<span class="token operator">-></span><span class="token function">toPlainText</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"' "</span></pre></td></tr><tr><td data-num="63"></td><td><pre>                            <span class="token string">"where sno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="64"></td><td><pre>        QMessageBox box<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="65"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="66"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Information<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="67"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"学生管理"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="68"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"修改成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="69"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="70"></td><td><pre>            <span class="token keyword">this</span><span class="token operator">-></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="71"></td><td><pre>            emit <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="72"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="73"></td><td><pre>        <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="74"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Critical<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="75"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"警告"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="76"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"修改失败，请检查数据正确性！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="77"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="78"></td><td><pre>            <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>query<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="79"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="80"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="81"></td><td><pre>        <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="82"></td><td><pre>    <span class="token keyword">case</span> ADD<span class="token operator">:</span></pre></td></tr><tr><td data-num="83"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="84"></td><td><pre>        QSqlQuery t <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"insert into student "</span></pre></td></tr><tr><td data-num="85"></td><td><pre>                            <span class="token string">"(sno, sname, sex, age, major, classno, status, phonenumber, jiangcheng, password) "</span></pre></td></tr><tr><td data-num="86"></td><td><pre>                            <span class="token string">"values ("</span></pre></td></tr><tr><td data-num="87"></td><td><pre>                            <span class="token string">" '"</span> <span class="token operator">+</span> ui<span class="token operator">-></span>Sno<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"', "</span></pre></td></tr><tr><td data-num="88"></td><td><pre>                            <span class="token string">" '"</span> <span class="token operator">+</span> ui<span class="token operator">-></span>Sname<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"', "</span></pre></td></tr><tr><td data-num="89"></td><td><pre>                            <span class="token string">" '"</span> <span class="token operator">+</span> ui<span class="token operator">-></span>Sex<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"', "</span></pre></td></tr><tr><td data-num="90"></td><td><pre>                            <span class="token string">" '"</span> <span class="token operator">+</span> ui<span class="token operator">-></span>Age<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"', "</span></pre></td></tr><tr><td data-num="91"></td><td><pre>                            <span class="token string">" '"</span> <span class="token operator">+</span> ui<span class="token operator">-></span>Major<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"', "</span></pre></td></tr><tr><td data-num="92"></td><td><pre>                            <span class="token string">" '"</span> <span class="token operator">+</span> ui<span class="token operator">-></span>Classno<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"', "</span></pre></td></tr><tr><td data-num="93"></td><td><pre>                            <span class="token string">" '"</span> <span class="token operator">+</span> ui<span class="token operator">-></span>Status<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"', "</span></pre></td></tr><tr><td data-num="94"></td><td><pre>                            <span class="token string">" '"</span> <span class="token operator">+</span> ui<span class="token operator">-></span>Phonenumber<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"', "</span></pre></td></tr><tr><td data-num="95"></td><td><pre>                            <span class="token string">" '"</span> <span class="token operator">+</span> ui<span class="token operator">-></span>Jiangcheng<span class="token operator">-></span><span class="token function">toPlainText</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"', "</span></pre></td></tr><tr><td data-num="96"></td><td><pre>                            <span class="token string">" '123456'); "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 默认密码 123456</span></pre></td></tr><tr><td data-num="97"></td><td><pre>        QMessageBox box<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="98"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>t<span class="token punctuation">.</span><span class="token function">isActive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="99"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Information<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="100"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/res/logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="101"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"学生管理"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="102"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"新增成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="103"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="104"></td><td><pre>            <span class="token keyword">this</span><span class="token operator">-></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="105"></td><td><pre>            emit <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="106"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="107"></td><td><pre>        <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="108"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Critical<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="109"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/res/logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="110"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"警告"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="111"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"新增失败，请检查数据正确性！"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="112"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="113"></td><td><pre>            <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>t<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="114"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="115"></td><td><pre></pre></td></tr><tr><td data-num="116"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="117"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="118"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="changepasswordcpp"><a class="anchor" href="#changepasswordcpp">#</a> changepassword.cpp</h2><figure class="highlight cpp"><figcaption data-lang="C++"><span>changepassword.cpp</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"changepassword.h"</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ui_changepassword.h"</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>changePassword<span class="token double-colon punctuation">::</span><span class="token function">changePassword</span><span class="token punctuation">(</span>QSqlDatabase db<span class="token punctuation">,</span> QString Username<span class="token punctuation">,</span> <span class="token keyword">int</span> UserType<span class="token punctuation">,</span> QWidget <span class="token operator">*</span>parent<span class="token punctuation">)</span> <span class="token operator">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token function">QWidget</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token function">ui</span><span class="token punctuation">(</span><span class="token keyword">new</span> Ui<span class="token double-colon punctuation">::</span>changePassword<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    ui<span class="token operator">-></span><span class="token function">setupUi</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token function">setWindowFlags</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>CustomizeWindowHint<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 隐藏标题栏</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token function">setFixedSize</span><span class="token punctuation">(</span><span class="token number">470</span><span class="token punctuation">,</span> <span class="token number">270</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    data <span class="token operator">=</span> db<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    username <span class="token operator">=</span> Username<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    userType <span class="token operator">=</span> UserType<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>userType<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">case</span> TEACHER<span class="token operator">:</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        ui<span class="token operator">-></span>Btn_Confirm<span class="token operator">-></span><span class="token function">setStyleSheet</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="21"></td><td><pre>                    <span class="token string">"QPushButton &#123;"</span></pre></td></tr><tr><td data-num="22"></td><td><pre>                    <span class="token string">"border: 1 solid #8c8c8c;"</span></pre></td></tr><tr><td data-num="23"></td><td><pre>                    <span class="token string">"border-radius: 5px;"</span></pre></td></tr><tr><td data-num="24"></td><td><pre>                    <span class="token string">"background : #107C41;"</span></pre></td></tr><tr><td data-num="25"></td><td><pre>                    <span class="token string">"color: #ffffff;"</span></pre></td></tr><tr><td data-num="26"></td><td><pre>                    <span class="token string">"&#125;"</span></pre></td></tr><tr><td data-num="27"></td><td><pre>                    <span class="token string">"QPushButton:hover &#123;"</span></pre></td></tr><tr><td data-num="28"></td><td><pre>                        <span class="token string">"background-color: #0F703B;"</span></pre></td></tr><tr><td data-num="29"></td><td><pre>                    <span class="token string">"&#125;"</span></pre></td></tr><tr><td data-num="30"></td><td><pre>                    <span class="token string">"QPushButton:pressed &#123;"</span></pre></td></tr><tr><td data-num="31"></td><td><pre>                        <span class="token string">"background-color: #107C41;"</span></pre></td></tr><tr><td data-num="32"></td><td><pre>                        <span class="token string">"border: 1 solid #000000;"</span></pre></td></tr><tr><td data-num="33"></td><td><pre>                    <span class="token string">"&#125;"</span></pre></td></tr><tr><td data-num="34"></td><td><pre>                    <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        ui<span class="token operator">-></span>Btn_Cancel<span class="token operator">-></span><span class="token function">setStyleSheet</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="36"></td><td><pre>                    <span class="token string">"QPushButton &#123;"</span></pre></td></tr><tr><td data-num="37"></td><td><pre>                        <span class="token string">"border-radius: 5px;"</span></pre></td></tr><tr><td data-num="38"></td><td><pre>                        <span class="token string">"background : #ffffff;"</span></pre></td></tr><tr><td data-num="39"></td><td><pre>                        <span class="token string">"color: #262626;"</span></pre></td></tr><tr><td data-num="40"></td><td><pre>                        <span class="token string">"border: 1 solid #8c8c8c;"</span></pre></td></tr><tr><td data-num="41"></td><td><pre>                    <span class="token string">"&#125;"</span></pre></td></tr><tr><td data-num="42"></td><td><pre></pre></td></tr><tr><td data-num="43"></td><td><pre>                    <span class="token string">"QPushButton:hover &#123;"</span></pre></td></tr><tr><td data-num="44"></td><td><pre>                       <span class="token string">" background-color: #E9F5EE;"</span></pre></td></tr><tr><td data-num="45"></td><td><pre>                    <span class="token string">"&#125;"</span></pre></td></tr><tr><td data-num="46"></td><td><pre></pre></td></tr><tr><td data-num="47"></td><td><pre>                    <span class="token string">"QPushButton:pressed &#123;"</span></pre></td></tr><tr><td data-num="48"></td><td><pre>                        <span class="token string">"background-color: #ffffff;"</span></pre></td></tr><tr><td data-num="49"></td><td><pre>                        <span class="token string">"border: 1 solid #000000;"</span></pre></td></tr><tr><td data-num="50"></td><td><pre>                    <span class="token string">"&#125;"</span></pre></td></tr><tr><td data-num="51"></td><td><pre>                    <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="52"></td><td><pre></pre></td></tr><tr><td data-num="53"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>        <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>    <span class="token keyword">case</span> STUDENT<span class="token operator">:</span></pre></td></tr><tr><td data-num="56"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="57"></td><td><pre>        ui<span class="token operator">-></span>Btn_Confirm<span class="token operator">-></span><span class="token function">setStyleSheet</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="58"></td><td><pre>                    <span class="token string">"QPushButton &#123;"</span></pre></td></tr><tr><td data-num="59"></td><td><pre>                    <span class="token string">"border: 1 solid #8c8c8c;"</span></pre></td></tr><tr><td data-num="60"></td><td><pre>                    <span class="token string">"border-radius: 5px;"</span></pre></td></tr><tr><td data-num="61"></td><td><pre>                    <span class="token string">"background : #185ABD;"</span></pre></td></tr><tr><td data-num="62"></td><td><pre>                    <span class="token string">"color: #ffffff;"</span></pre></td></tr><tr><td data-num="63"></td><td><pre>                    <span class="token string">"&#125;"</span></pre></td></tr><tr><td data-num="64"></td><td><pre>                    <span class="token string">"QPushButton:hover &#123;"</span></pre></td></tr><tr><td data-num="65"></td><td><pre>                        <span class="token string">"background-color: #1651AA;"</span></pre></td></tr><tr><td data-num="66"></td><td><pre>                    <span class="token string">"&#125;"</span></pre></td></tr><tr><td data-num="67"></td><td><pre>                    <span class="token string">"QPushButton:pressed &#123;"</span></pre></td></tr><tr><td data-num="68"></td><td><pre>                        <span class="token string">"background-color: #185ABD;"</span></pre></td></tr><tr><td data-num="69"></td><td><pre>                        <span class="token string">"border: 1 solid #000000;"</span></pre></td></tr><tr><td data-num="70"></td><td><pre>                    <span class="token string">"&#125;"</span></pre></td></tr><tr><td data-num="71"></td><td><pre>                    <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="72"></td><td><pre>        ui<span class="token operator">-></span>Btn_Cancel<span class="token operator">-></span><span class="token function">setStyleSheet</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="73"></td><td><pre>                    <span class="token string">"QPushButton &#123;"</span></pre></td></tr><tr><td data-num="74"></td><td><pre>                        <span class="token string">"border-radius: 5px;"</span></pre></td></tr><tr><td data-num="75"></td><td><pre>                        <span class="token string">"background : #ffffff;"</span></pre></td></tr><tr><td data-num="76"></td><td><pre>                        <span class="token string">"color: #262626;"</span></pre></td></tr><tr><td data-num="77"></td><td><pre>                        <span class="token string">"border: 1 solid #8c8c8c;"</span></pre></td></tr><tr><td data-num="78"></td><td><pre>                    <span class="token string">"&#125;"</span></pre></td></tr><tr><td data-num="79"></td><td><pre></pre></td></tr><tr><td data-num="80"></td><td><pre>                    <span class="token string">"QPushButton:hover &#123;"</span></pre></td></tr><tr><td data-num="81"></td><td><pre>                       <span class="token string">" background-color: #d9def5;"</span></pre></td></tr><tr><td data-num="82"></td><td><pre>                    <span class="token string">"&#125;"</span></pre></td></tr><tr><td data-num="83"></td><td><pre></pre></td></tr><tr><td data-num="84"></td><td><pre>                    <span class="token string">"QPushButton:pressed &#123;"</span></pre></td></tr><tr><td data-num="85"></td><td><pre>                        <span class="token string">"background-color: #ffffff;"</span></pre></td></tr><tr><td data-num="86"></td><td><pre>                        <span class="token string">"border: 1 solid #000000;"</span></pre></td></tr><tr><td data-num="87"></td><td><pre>                    <span class="token string">"&#125;"</span></pre></td></tr><tr><td data-num="88"></td><td><pre>                    <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="89"></td><td><pre></pre></td></tr><tr><td data-num="90"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="91"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="92"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="93"></td><td><pre></pre></td></tr><tr><td data-num="94"></td><td><pre><span class="token class-name">changePassword</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">changePassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="95"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="96"></td><td><pre>    <span class="token keyword">delete</span> ui<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="97"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="98"></td><td><pre></pre></td></tr><tr><td data-num="99"></td><td><pre><span class="token keyword">void</span> changePassword<span class="token double-colon punctuation">::</span><span class="token function">on_Btn_Confirm_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="100"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="101"></td><td><pre>    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="102"></td><td><pre>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>userType<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="103"></td><td><pre>    <span class="token keyword">case</span> TEACHER<span class="token operator">:</span></pre></td></tr><tr><td data-num="104"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="105"></td><td><pre>        query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select password "</span></pre></td></tr><tr><td data-num="106"></td><td><pre>                   <span class="token string">"from teacher "</span></pre></td></tr><tr><td data-num="107"></td><td><pre>                   <span class="token string">"where tno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="108"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="109"></td><td><pre>        <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="110"></td><td><pre>    <span class="token keyword">case</span> STUDENT<span class="token operator">:</span></pre></td></tr><tr><td data-num="111"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="112"></td><td><pre>        query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select password "</span></pre></td></tr><tr><td data-num="113"></td><td><pre>                   <span class="token string">"from student "</span></pre></td></tr><tr><td data-num="114"></td><td><pre>                   <span class="token string">"where sno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="115"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="116"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="117"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">isActive</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> ui<span class="token operator">-></span>oldline<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="118"></td><td><pre>        QString new_1 <span class="token operator">=</span> ui<span class="token operator">-></span>newline<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="119"></td><td><pre>        QString new_2 <span class="token operator">=</span> ui<span class="token operator">-></span>confirmline<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="120"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>new_1 <span class="token operator">!=</span> new_2<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="121"></td><td><pre>            QMessageBox box<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="122"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Warning<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="123"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/res/logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="124"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"警告"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="125"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"请确认密码"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="126"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="127"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="128"></td><td><pre>        <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="129"></td><td><pre>            QSqlQuery <span class="token function">query_new</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="130"></td><td><pre>            <span class="token keyword">switch</span> <span class="token punctuation">(</span>userType<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="131"></td><td><pre>            <span class="token keyword">case</span> TEACHER<span class="token operator">:</span></pre></td></tr><tr><td data-num="132"></td><td><pre>            <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="133"></td><td><pre>                query_new<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"update teacher "</span></pre></td></tr><tr><td data-num="134"></td><td><pre>                               <span class="token string">"set password = '"</span> <span class="token operator">+</span> new_1 <span class="token operator">+</span> <span class="token string">"' "</span></pre></td></tr><tr><td data-num="135"></td><td><pre>                               <span class="token string">"where tno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"' "</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="136"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="137"></td><td><pre>                <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="138"></td><td><pre>            <span class="token keyword">case</span> STUDENT<span class="token operator">:</span></pre></td></tr><tr><td data-num="139"></td><td><pre>            <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="140"></td><td><pre>                query_new<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"update student "</span></pre></td></tr><tr><td data-num="141"></td><td><pre>                               <span class="token string">"set password = '"</span> <span class="token operator">+</span> new_1 <span class="token operator">+</span> <span class="token string">"' "</span></pre></td></tr><tr><td data-num="142"></td><td><pre>                               <span class="token string">"where sno = '"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"' "</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="143"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="144"></td><td><pre></pre></td></tr><tr><td data-num="145"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="146"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span>query_new<span class="token punctuation">.</span><span class="token function">isActive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="147"></td><td><pre>                QMessageBox box<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="148"></td><td><pre>                box<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Information<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="149"></td><td><pre>                box<span class="token punctuation">.</span><span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/res/logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="150"></td><td><pre>                box<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"密码更改"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="151"></td><td><pre>                box<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"修改成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="152"></td><td><pre>                box<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="153"></td><td><pre>                <span class="token keyword">this</span><span class="token operator">-></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="154"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="155"></td><td><pre>            <span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="156"></td><td><pre>                QMessageBox box<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="157"></td><td><pre>                box<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Critical<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="158"></td><td><pre>                box<span class="token punctuation">.</span><span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/res/logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="159"></td><td><pre>                box<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"警告"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="160"></td><td><pre>                box<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"修改失败"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="161"></td><td><pre>                box<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="162"></td><td><pre>                <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>query_new<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="163"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="164"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="165"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="166"></td><td><pre>    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="167"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>query<span class="token punctuation">.</span><span class="token function">isActive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="168"></td><td><pre>            <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>query<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="169"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="170"></td><td><pre>        <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="171"></td><td><pre>            QMessageBox box<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="172"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Critical<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="173"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/res/logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="174"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"警告"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="175"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"密码错误"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="176"></td><td><pre>            box<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="177"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="178"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="179"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="180"></td><td><pre></pre></td></tr><tr><td data-num="181"></td><td><pre><span class="token keyword">void</span> changePassword<span class="token double-colon punctuation">::</span><span class="token function">on_Btn_Cancel_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="182"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="183"></td><td><pre>        <span class="token keyword">this</span><span class="token operator">-></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="184"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="resetcpp"><a class="anchor" href="#resetcpp">#</a> reset.cpp</h2><figure class="highlight cpp"><figcaption data-lang="C++"><span>reset.cpp</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"reset.h"</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ui_reset.h"</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token class-name">Reset</span><span class="token double-colon punctuation">::</span><span class="token function">Reset</span><span class="token punctuation">(</span>QString name<span class="token punctuation">,</span> QWidget <span class="token operator">*</span>parent<span class="token punctuation">)</span> <span class="token operator">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token function">QWidget</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token function">ui</span><span class="token punctuation">(</span><span class="token keyword">new</span> Ui<span class="token double-colon punctuation">::</span>Reset<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    ui<span class="token operator">-></span><span class="token function">setupUi</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token function">setWindowFlags</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>CustomizeWindowHint<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 隐藏标题栏</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token function">setFixedSize</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">this</span><span class="token operator">-></span>name <span class="token operator">=</span> name<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token class-name">Reset</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">Reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">delete</span> ui<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">Reset</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_No_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">this</span><span class="token operator">-></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">Reset</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_Yes_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>ui<span class="token operator">-></span>Name<span class="token operator">-></span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token keyword">this</span><span class="token operator">-></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        emit <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>        QMessageBox box<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span>QMessageBox<span class="token double-colon punctuation">::</span>Critical<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setWindowIcon</span><span class="token punctuation">(</span><span class="token function">QIcon</span><span class="token punctuation">(</span><span class="token string">":/res/logo.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setWindowTitle</span><span class="token punctuation">(</span><span class="token string">"警告"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"验证失败"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>        box<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="41"></td><td><pre></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="staticscpp"><a class="anchor" href="#staticscpp">#</a> statics.cpp</h2><figure class="highlight cpp"><figcaption data-lang="C++"><span>statics.cpp</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"statics.h"</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"ui_statics.h"</span></span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token class-name">Statics</span><span class="token double-colon punctuation">::</span><span class="token function">Statics</span><span class="token punctuation">(</span>QSqlDatabase db<span class="token punctuation">,</span> QString Course<span class="token punctuation">,</span> QWidget <span class="token operator">*</span>parent<span class="token punctuation">)</span> <span class="token operator">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token function">QWidget</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token function">ui</span><span class="token punctuation">(</span><span class="token keyword">new</span> Ui<span class="token double-colon punctuation">::</span>Statics<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    ui<span class="token operator">-></span><span class="token function">setupUi</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token function">setWindowFlags</span><span class="token punctuation">(</span>Qt<span class="token double-colon punctuation">::</span>CustomizeWindowHint<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 隐藏标题栏</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token function">setFixedSize</span><span class="token punctuation">(</span><span class="token number">360</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    database <span class="token operator">=</span> db<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    course <span class="token operator">=</span> Course<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token function">avg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 求平均分</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 求不及格人数</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token function">per</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 求挂科率</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token class-name">Statics</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">Statics</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token keyword">delete</span> ui<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">Statics</span><span class="token double-colon punctuation">::</span><span class="token function">on_Btn_yes_clicked</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token keyword">this</span><span class="token operator">-></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="31"></td><td><pre></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">Statics</span><span class="token double-colon punctuation">::</span><span class="token function">avg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>database<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select avg(score) "</span></pre></td></tr><tr><td data-num="35"></td><td><pre>               <span class="token string">"from sc "</span></pre></td></tr><tr><td data-num="36"></td><td><pre>               <span class="token string">"where score > 0 and cno = '"</span> <span class="token operator">+</span> course <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>        ui<span class="token operator">-></span>avg<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token char">'f'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token keyword">else</span> ui<span class="token operator">-></span>avg<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="42"></td><td><pre></pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">Statics</span><span class="token double-colon punctuation">::</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>    QSqlQuery <span class="token function">query</span><span class="token punctuation">(</span>database<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select count(sno) "</span></pre></td></tr><tr><td data-num="46"></td><td><pre>               <span class="token string">"from sc "</span></pre></td></tr><tr><td data-num="47"></td><td><pre>               <span class="token string">"where score > 0 and score &lt; 60 and cno = '"</span> <span class="token operator">+</span> course <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>        ui<span class="token operator">-></span>count<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>    <span class="token keyword">else</span> ui<span class="token operator">-></span>count<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="53"></td><td><pre></pre></td></tr><tr><td data-num="54"></td><td><pre><span class="token keyword">void</span> <span class="token class-name">Statics</span><span class="token double-colon punctuation">::</span><span class="token function">per</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>    QSqlQuery <span class="token function">query_fz</span><span class="token punctuation">(</span>database<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>    QSqlQuery <span class="token function">query_fm</span><span class="token punctuation">(</span>database<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="57"></td><td><pre>    <span class="token keyword">double</span> per<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="58"></td><td><pre>    query_fz<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select count(sno) "</span></pre></td></tr><tr><td data-num="59"></td><td><pre>                  <span class="token string">"from sc "</span></pre></td></tr><tr><td data-num="60"></td><td><pre>                  <span class="token string">"where score > 0 and score &lt; 60 and cno = '"</span> <span class="token operator">+</span> course <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="61"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>query_fz<span class="token punctuation">.</span><span class="token function">isActive</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> query_fz<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>per <span class="token operator">=</span> query_fz<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="62"></td><td><pre>    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="63"></td><td><pre>        ui<span class="token operator">-></span>per<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="64"></td><td><pre>        <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>query_fz<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="65"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="66"></td><td><pre>    query_fm<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"select count(sno) "</span></pre></td></tr><tr><td data-num="67"></td><td><pre>               <span class="token string">"from sc "</span></pre></td></tr><tr><td data-num="68"></td><td><pre>               <span class="token string">"where score > 0 and cno = '"</span> <span class="token operator">+</span> course <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="69"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>query_fm<span class="token punctuation">.</span><span class="token function">isActive</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> query_fm<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> query_fm<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>per <span class="token operator">/=</span> query_fm<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="70"></td><td><pre>    <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="71"></td><td><pre>        per <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="72"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>query_fm<span class="token punctuation">.</span><span class="token function">isActive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="73"></td><td><pre>            <span class="token function">qDebug</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>query_fm<span class="token punctuation">.</span><span class="token function">lastError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="74"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="75"></td><td><pre>    ui<span class="token operator">-></span>per<span class="token operator">-></span><span class="token function">setText</span><span class="token punctuation">(</span>per <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">?</span> <span class="token string">"/"</span> <span class="token operator">:</span> <span class="token class-name">QString</span><span class="token double-colon punctuation">::</span><span class="token function">number</span><span class="token punctuation">(</span>per<span class="token punctuation">,</span> <span class="token char">'f'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"%"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="76"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><div class="tags"><a href="/tags/%E8%AE%A1%E8%BD%AF%E5%AE%9E%E4%B9%A0%E9%A1%B9%E7%9B%AE/" rel="tag"><i class="ic i-tag"></i> 计软实习项目</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2023-01-10 14:25:46" itemprop="dateModified" datetime="2023-01-10T14:25:46+08:00">2023-01-10</time> </span><span id="Project/Student-Information-Management-System/Student-Information-Management-System2/" class="item leancloud_visitors" data-flag-title="学生信息管理系统代码实现" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="RainbowCat 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt="RainbowCat 支付宝"><p>支付宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>RainbowCat <i class="ic i-at"><em>@</em></i>レインボーハウス</li><li class="link"><strong>本文链接：</strong> <a href="https://xylrainbowcat.github.io/Project/Student-Information-Management-System/Student-Information-Management-System2/" title="学生信息管理系统代码实现">https://xylrainbowcat.github.io/Project/Student-Information-Management-System/Student-Information-Management-System2/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/Project/Snake-gluttony/Snake-gluttony2/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;i.loli.net&#x2F;2020&#x2F;10&#x2F;30&#x2F;HKyzSd7NI3mlBpt.jpg" title="贪吃蛇代码实现"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 贪吃蛇</span><h3>贪吃蛇代码实现</h3></a></div><div class="item right"></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A4%B4%E6%96%87%E4%BB%B6"><span class="toc-number">1.</span> <span class="toc-text">头文件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#globelh"><span class="toc-number">1.1.</span> <span class="toc-text">globel.h</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#loginwindowh"><span class="toc-number">1.2.</span> <span class="toc-text">loginwindow.h</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#studentwindowh"><span class="toc-number">1.3.</span> <span class="toc-text">studentwindow.h</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#teacherwindowh"><span class="toc-number">1.4.</span> <span class="toc-text">teacherwindow.h</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#modifystudenth"><span class="toc-number">1.5.</span> <span class="toc-text">modifystudent.h</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#changepasswordh"><span class="toc-number">1.6.</span> <span class="toc-text">changepassword.h</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reseth"><span class="toc-number">1.7.</span> <span class="toc-text">reset.h</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#staticsh"><span class="toc-number">1.8.</span> <span class="toc-text">statics.h</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%BA%90%E6%96%87%E4%BB%B6"><span class="toc-number">2.</span> <span class="toc-text">源文件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#loginwindowcpp"><span class="toc-number">2.1.</span> <span class="toc-text">loginwindow.cpp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#studentwindowcpp"><span class="toc-number">2.2.</span> <span class="toc-text">studentwindow.cpp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#teacherwindowcpp"><span class="toc-number">2.3.</span> <span class="toc-text">teacherwindow.cpp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#modifystudentcpp"><span class="toc-number">2.4.</span> <span class="toc-text">modifystudent.cpp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#changepasswordcpp"><span class="toc-number">2.5.</span> <span class="toc-text">changepassword.cpp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#resetcpp"><span class="toc-number">2.6.</span> <span class="toc-text">reset.cpp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#staticscpp"><span class="toc-number">2.7.</span> <span class="toc-text">statics.cpp</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/Project/Student-Information-Management-System/Student-Information-Management-System/" rel="bookmark" title="小型信息管理系统的设计与实现">小型信息管理系统的设计与实现</a></li><li class="active"><a href="/Project/Student-Information-Management-System/Student-Information-Management-System2/" rel="bookmark" title="学生信息管理系统代码实现">学生信息管理系统代码实现</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="RainbowCat" data-src="/images/avatar.png"><p class="name" itemprop="name">RainbowCat</p><div class="description" itemprop="description">项目 & 编程笔记</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">10</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">6</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">3</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL3h5bHJhaW5ib3djYXQ=" title="https:&#x2F;&#x2F;github.com&#x2F;xylrainbowcat"><i class="ic i-github"></i></span> <span class="exturl item bilibili" data-url="aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTE5MjYxNzczP3NwbV9pZF9mcm9tPTMzMy4xMDA3LjAuMA==" title="https:&#x2F;&#x2F;space.bilibili.com&#x2F;519261773?spm_id_from&#x3D;333.1007.0.0"><i class="ic i-bilibili"></i></span> <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20veHlscmFpbmJvd2NhdA==" title="https:&#x2F;&#x2F;weibo.com&#x2F;xylrainbowcat"><i class="ic i-weibo"></i></span> <span class="exturl item facebook" data-url="aHR0cHM6Ly93d3cuZmFjZWJvb2suY29tL3h5bHJhaW5ib3djYXQ=" title="https:&#x2F;&#x2F;www.facebook.com&#x2F;xylrainbowcat"><i class="ic i-facebook"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>友链</a></li><li class="item"><a href="/logs/" rel="section"><i class="ic i-magic"></i>日志</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/Project/" title="分类于 计软实习项目">计软实习项目</a> <i class="ic i-angle-right"></i> <a href="/categories/Project/Snake-gluttony/" title="分类于 贪吃蛇">贪吃蛇</a></div><span><a href="/Project/Snake-gluttony/Snake-gluttony2/" title="贪吃蛇代码实现">贪吃蛇代码实现</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Project/" title="分类于 计软实习项目">计软实习项目</a> <i class="ic i-angle-right"></i> <a href="/categories/Project/Snake-gluttony/" title="分类于 贪吃蛇">贪吃蛇</a></div><span><a href="/Project/Snake-gluttony/Snake-gluttony/" title="贪吃蛇的游戏开发">贪吃蛇的游戏开发</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Project/" title="分类于 计软实习项目">计软实习项目</a> <i class="ic i-angle-right"></i> <a href="/categories/Project/Maze/" title="分类于 迷宫">迷宫</a></div><span><a href="/Project/Maze/Maze2/" title="迷宫代码实现">迷宫代码实现</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Study-Notes/" title="分类于 学习笔记">学习笔记</a></div><span><a href="/Study-Notes/Qt-Study-Notes/" title="Qt 学习笔记">Qt 学习笔记</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Project/" title="分类于 计软实习项目">计软实习项目</a> <i class="ic i-angle-right"></i> <a href="/categories/Project/Student-Information-Management-System/" title="分类于 学生信息管理系统">学生信息管理系统</a></div><span><a href="/Project/Student-Information-Management-System/Student-Information-Management-System/" title="小型信息管理系统的设计与实现">小型信息管理系统的设计与实现</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Project/" title="分类于 计软实习项目">计软实习项目</a> <i class="ic i-angle-right"></i> <a href="/categories/Project/Calculator/" title="分类于 计算器">计算器</a></div><span><a href="/Project/Calculator/Calculator2/" title="计算器代码实现">计算器代码实现</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Project/" title="分类于 计软实习项目">计软实习项目</a> <i class="ic i-angle-right"></i> <a href="/categories/Project/Calculator/" title="分类于 计算器">计算器</a></div><span><a href="/Project/Calculator/Calculator/" title="简单计算器的实现">简单计算器的实现</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Project/" title="分类于 计软实习项目">计软实习项目</a> <i class="ic i-angle-right"></i> <a href="/categories/Project/Maze/" title="分类于 迷宫">迷宫</a></div><span><a href="/Project/Maze/Maze/" title="基于A*搜索算法迷宫游戏开发">基于A*搜索算法迷宫游戏开发</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/hello-world/" title="Hello World">Hello World</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Project/" title="分类于 计软实习项目">计软实习项目</a> <i class="ic i-angle-right"></i> <a href="/categories/Project/Student-Information-Management-System/" title="分类于 学生信息管理系统">学生信息管理系统</a></div><span><a href="/Project/Student-Information-Management-System/Student-Information-Management-System2/" title="学生信息管理系统代码实现">学生信息管理系统代码实现</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2022 – <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">RainbowCat @ RainbowHouse</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">133k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">2:01</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"Project/Student-Information-Management-System/Student-Information-Management-System2/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,mermaid:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html>